(this.webpackJsonpswft=this.webpackJsonpswft||[]).push([[3],{328:function(e,t,a){},329:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return j}));var n=a(6),i=a(8),l=a(12),o=a(11),c=a(0),r=a(78),s=a(268),d=a(49),m=a(322),p=a(321),h=a(102),u=a(317),f=a(94),v=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).getUpdatedDatevalue=function(e,t,a){var n=new Date(a);return e?n.setDate(n.getDate()+7):n.setDate(n.getDate()-7),n},i.getLastFlag=function(e,t){return t<=f.j},i.handleOffsetAddition=function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget.id,a=i.state,n=a.offset,l=a.calDate,o=!0;if("next"===t){o=!0;var c=n+1,r=i.getUpdatedDatevalue(!0,c,l);i.setState({offset:c,lastDisabled:!1,nextDisabled:!1,calDate:r})}else{o=!1;var s=n-1;r=i.getUpdatedDatevalue(!1,s,l);i.setState({offset:s,lastDisabled:!1,nextDisabled:!1,calDate:r})}i.props.handleChange(r,o)},i.handleDateSelect=function(e){var t=i.state.calDate;if(e&&Object(f.d)(e)!=Object(f.d)(t)){i.setState({calDate:e,lastDisabled:!1,nextDisabled:!1,offset:1}),i.props.handleChange(e,!1)}},i.state={calDate:f.j,lastDisabled:!1,nextDisabled:!1,offset:1},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.calDate;this.setState({calDate:e})}},{key:"render",value:function(){var e=this.state,t=e.calDate,a=e.nextDisabled,n=e.lastDisabled;return c.createElement("div",{style:{overflow:"auto",width:"100%",padding:"30px 0 10px 0"}},c.createElement("div",{className:"CalControl",style:{width:"52%",float:"left"}},c.createElement("div",{style:{fontSize:"12pt",fontWeight:"bold",float:"left",width:"20%",textAlign:"left"}},"Calendar"),c.createElement("div",{className:"CalMainControl",style:{float:"right",width:"50%"}},c.createElement("div",{className:"dateControls",style:{width:"50%",float:"left"}},c.createElement(h.a,{showNonFormLabel:!1,labelHead:"Start Date",isPast:!0,updateFunc:this.handleDateSelect,dateInput:t})),c.createElement("div",{className:"navControl",style:{width:"43%",float:"right"}},c.createElement(u.a,{title:"Get Last 7 Days Activities",onClick:this.handleOffsetAddition,id:"last",disabled:n},"Last 7 Days"),c.createElement("span",{style:{padding:"0 5px 0 5px"}},"|"),c.createElement(u.a,{title:"Get Last 7 Days Activities",onClick:this.handleOffsetAddition,id:"next",disabled:a}," ","Next 7 Days")))),c.createElement("div",{className:"CalendarLedger",style:{width:"47%",float:"right",padding:"0px 0 10px 0"}},c.createElement("div",{className:"ledgerIconDiv"},c.createElement(p.a,{iconName:"SquareShapeSolid",className:"calendar_icon calendar_icon_white"}),c.createElement("label",{className:"ms-Label"}," No Bookings")),c.createElement("div",{className:"ledgerIconDiv"},c.createElement(p.a,{iconName:"SquareShapeSolid",className:"calendar_icon calendar_icon_green"}),c.createElement("label",{className:"ms-Label"}," Partially Booked")),c.createElement("div",{className:"ledgerIconDiv"},c.createElement(p.a,{iconName:"SquareShapeSolid",className:"calendar_icon calendar_icon_grey"}),c.createElement("label",{className:"ms-Label"}," Fully Booked")),c.createElement("div",{className:"ledgerIconDiv"},c.createElement(p.a,{iconName:"SquareShapeSolid",className:"calendar_icon calendar_icon_red"}),c.createElement("label",{className:"ms-Label"}," Overbooked")),c.createElement("div",{className:"ledgerIconDiv"},c.createElement(p.a,{iconName:"Contact",style:{fontWeight:"bold"}}),c.createElement("label",{className:"ms-Label"}," My Activities"))))}}]),a}(c.Component),y=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).renderCoin=function(e,t,a,n){var l=i.state,o=(l.locationId,l.date);switch(t){case"White":return c.createElement(p.a,{iconName:a?"Contact":"SquareShapeSolid",className:a?"calendar_icon_white starIconClass":"calendar_icon calendar_icon_white",onClick:function(t){return i.props.handleIconClick(t,o,n,e)}});case"Green":return c.createElement(p.a,{iconName:a?"Contact":"SquareShapeSolid",className:a?"calendar_icon_green starIconClass":"calendar_icon calendar_icon_green",onClick:function(t){return i.props.handleIconClick(t,o,n,e)}});case"Grey":return c.createElement(p.a,{iconName:a?"Contact":"SquareShapeSolid",className:a?"calendar_icon_grey starIconClass":"calendar_icon calendar_icon_grey",onClick:function(t){return i.props.handleIconClick(t,o,n,e)}});case"Red":return c.createElement(p.a,{iconName:a?"Contact":"SquareShapeSolid",className:a?"calendar_icon_red starIconClass":"calendar_icon calendar_icon_red",onClick:function(t){return i.props.handleIconClick(t,o,n,e)}})}},i.state={shiftData:[],locationCapacity:0,locationId:0,date:""},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.shiftData,a=e.date,n=e.locationCapacity,i=e.locationId;this.setState({locationId:i,locationCapacity:n,shiftData:t,date:a})}},{key:"componentDidUpdate",value:function(e,t){var a=this.state,n=a.shiftData,i=a.locationId,l=a.date,o=a.locationCapacity;e.shiftData.length!==n.length&&this.setState({shiftData:this.props.shiftData,locationId:this.props.locationId,locationCapacity:this.props.locationCapacity,date:this.props.date}),e.locationId!==i&&this.setState({shiftData:this.props.shiftData,locationId:this.props.locationId,locationCapacity:this.props.locationCapacity,date:this.props.date}),e.locationCapacity!==o&&this.setState({shiftData:this.props.shiftData,locationId:this.props.locationId,locationCapacity:this.props.locationCapacity,date:this.props.date}),e.date!==l&&this.setState({shiftData:this.props.shiftData,locationId:this.props.locationId,locationCapacity:this.props.locationCapacity,date:this.props.date})}},{key:"render",value:function(){var e=this,t=this.state,a=t.shiftData,n=t.locationCapacity,i=this.props.location;return c.createElement("div",{className:"ms-Grid-row CalendarCoinClass"},a.length>0?a.map((function(t,a){return c.createElement("div",{key:a+"coin",className:"ms-Grid-col ms-sm3 calendatCoinDiv",title:t.ActivityNumber+"/"+n},e.renderCoin(t,t.ShiftColor,t.isStar,i))})):"")}}]),a}(c.Component),g=a(9),E=a.n(g),D=a(163),C=a(5),b=a(65),S=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).CreateChunkAndFill=function(e,t){for(var a=Object(g.chunk)(t,e),n=0;n<a.length;n++)if(a[n].length<e)for(var i=e-a[n].length,l=0;l<i;l++)a[n].push({});return a},i.getLocationSpecificArr=function(e,t){var a=null===e||void 0===e?void 0:e.split(","),n=i.props.LocationsData;if(a.length>0){var l=E.a.filter(n,{LocationId:t});if(l&&l.length>0){var o=l[0];return a.filter((function(e){return-1!==o.EquipmentArr.indexOf(e)}))}}return a},i.state={activityTilesArr:[]},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.activityTilesArr;this.setState({activityTilesArr:e})}},{key:"componentDidUpdate",value:function(e,t){this.props.activityTilesArr.length!==this.props.activityTilesArr.length&&this.setState({activityTilesArr:this.props.activityTilesArr})}},{key:"render",value:function(){var e=this,t=this.props,a=t.maxTilesPerRow,n=t.heading,i=this.state.activityTilesArr,l=this.CreateChunkAndFill(a,i),o=C.a.ActivityForm.officeSpaceUsageLocation;return c.createElement(c.Fragment,null,c.createElement("div",{style:{padding:"5px 5px 10px 5px",fontWeight:"bold",fontSize:"1em"}},n.split("|").map((function(e,t){return c.createElement("div",{key:t},e)}))),l.map((function(t,a){return c.createElement("div",{key:b(),style:{backgroundColor:"transparent",margin:"0 auto ",width:"95%",fontSize:"14px"}},t.map((function(t,a){var n=t.EquipmentName?e.getLocationSpecificArr(t.EquipmentName,t.LocationId):[],i=t.IsEmployee?t.BookedForEmail:t.BookedByEmail;return t.ActivityId?c.createElement("div",{key:b()},c.createElement("div",{style:{boxShadow:r.a.depth16,borderRadius:"10px",minHeight:"100px",color:"#fff"}},c.createElement("div",{title:t.ActivityName,"data-title":t.ActivityName,className:"activityContaitner",style:{padding:"0px"}},c.createElement("div",{className:"activityHeadingSection",style:{backgroundColor:"#4f4e4d",borderRadius:"10px 10px 0px 0px",padding:"5px 5px 5px 10px",minHeight:"20px"}},c.createElement("div",{style:{width:"80%",float:"left"}},t.ActivityName.length>20?t.ActivityName.substring(0,30)+"...":t.ActivityName),c.createElement("div",{style:{width:"20%",float:"right",textAlign:"right"}},c.createElement("span",null,t.ExperimentId?c.createElement(D.a,{iconName:"TestPlan",title:"Part of an experiment",style:{color:"#fff",fontSize:"1.25em",verticalAlign:"bottom"}}):""))),c.createElement("div",{title:t.BookedForName,style:{color:"#4f4e4d",paddingLeft:"10px",wordBreak:"break-all"}},c.createElement("span",{style:{fontWeight:"bold"}},"Booked For:"),c.createElement("div",{style:{fontSize:"1em"}},t.IsEmployee?c.createElement("span",{style:{wordBreak:"break-word"}},t.BookedForName,c.createElement("a",{href:"msteams:/l/chat/0/0?users="+i,style:{paddingLeft:"10px"}},c.createElement(D.a,{iconName:"TeamsLogo16",title:"Chat",style:{color:"#5A5B96",fontSize:"1em",verticalAlign:"bottom"}}))):c.createElement("div",{style:{display:"flex",flexDirection:"column"}},c.createElement("span",null,t.BookedForEmail),c.createElement("span",null,"(Host: "+t.BookedByName+")",c.createElement("a",{href:"msteams:/l/chat/0/0?users="+i,style:{paddingLeft:"10px"}},c.createElement(D.a,{iconName:"TeamsLogo16",title:"Chat",style:{color:"#5A5B96",fontSize:"1em",verticalAlign:"bottom"}})))))),t.ExperimentName?c.createElement("div",{style:{color:"#4f4e4d",padding:"5px 10px 5px 10px",overflow:"auto"}},c.createElement("span",{style:{fontWeight:"bold"}},"Experiment Name:"),c.createElement("div",{style:{fontSize:"1em"}}," ",t.ExperimentName," ")):"",t.LocationId===o?"":c.createElement("div",{title:"Equipments",style:{color:"#4f4e4d",padding:"5px 10px 5px 10px",overflow:"auto"}},c.createElement("span",{style:{fontWeight:"bold"}},"Equipment Reserved:"),c.createElement("div",{style:{fontSize:"1em"}}," ",n.length>0?n.join(", "):"None"," ")))),c.createElement("div",{style:{height:"10px"}})):c.createElement("div",{key:a})})))})))}}]),a}(c.Component),N=a(80),k=a(44),x=a(65),A=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.TotalCountArr;return c.createElement("tr",null,c.createElement("td",{key:x()},"Total Distinct People"),e.map((function(e){return c.createElement("td",{key:x()},c.createElement("div",{className:"ms-Grid-row CalendarCoinClass"},e.ShiftData.map((function(e,t){return c.createElement("div",{key:t+"coin",className:"ms-Grid-col ms-sm3 calendatCoinDiv"},e.ActivityNumber)}))))})))}}]),a}(c.Component),I=a(65),L=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).getDataFromDB=function(e,t){var a=[],n=e||i.state.calDate,l=i.context.userName;t?(a.push(Object(f.f)()),a.push(Object(f.i)()),a.push(Object(f.e)(n)),Promise.all(a).then((function(e){if(e&&e.length>0){var t=i.state.nextDays,a=Object(f.g)(e[0]),n=Object(f.b)(t,a,e[1],e[2],l);i.setState({locationdata:a,shiftData:e[1],activitiesData:n.activitiesData,calendarData:n.calendarData,totolCountArr:n.totolCountArr,isLoading:!1})}})).then((function(){var e=document.getElementById("calendarGrid");i.setState({gridHeight:e?e.clientHeight:i.state.gridHeight})})).catch((function(e){console.log(e)}))):(i.setState({isLoading:!0}),Object(f.e)(n).then((function(e){if(e){var t=i.state,a=t.nextDays,n=t.locationdata,o=t.shiftData,c=Object(f.b)(a,n,o,e,l);i.setState({activitiesData:c.activitiesData,calendarData:c.calendarData,totolCountArr:c.totolCountArr,isLoading:!1})}})).then((function(){var e=document.getElementById("calendarGrid");i.setState({gridHeight:e?e.clientHeight:i.state.gridHeight})})).catch((function(e){console.log(e)})))},i.handleControlInput=function(e,t){i.setState({calDate:e,nextDays:Object(f.h)(e,6)}),i.getDataFromDB(e,!1)},i.handleShiftClick=function(e,t,a,n){e.preventDefault();var l=a.LocationId;i.setState({userClickAction:!0});var o=i.state,c=o.activitiesData,r=(o.locationdata,Object(f.a)(c,l,t,n.ShiftId)),s=Object(f.c)(t)+" "+n.ShiftName+"|"+a.LocationName+" - "+n.ActivityNumber+"/"+a.LocationCapacity;i.setState({userClickAction:!1,filteredData:r,tilesListKey:I(),activityHeader:s})},i.loadSpinner=function(e,t){return c.createElement("div",{className:"centeredContainer"},c.createElement(N.a,{label:e,hideDialog:!t}))},a.contextType=k.b,i.state={nextDays:[],calDate:f.j,locationdata:[],shiftData:[],activitiesData:[],calendarData:[],totolCountArr:[],isLoading:!0,userClickAction:!1,filteredData:[],activityHeader:"Activities",tilesListKey:I(),gridHeight:0},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.setState({nextDays:Object(f.h)(f.j,6),isLoading:!0}),this.getDataFromDB(null,!0)}},{key:"render",value:function(){var e=this,t=this.state,a=t.calDate,n=t.nextDays,i=t.calendarData,l=t.locationdata,o=t.isLoading,p=t.filteredData,h=t.activityHeader,u=t.userClickAction,f=t.totolCountArr,g=t.tilesListKey;return c.createElement("div",{style:{width:"100%",textAlign:"center",overflow:"auto"}},c.createElement("div",{className:"Calendar"},c.createElement(v,{calDate:a,handleChange:this.handleControlInput}),c.createElement("div",{dir:"ltr",style:{boxShadow:r.a.depth16}},c.createElement("div",{className:"CalendarBody"},o?this.loadSpinner("Loading...",o):c.createElement("div",{id:"calendarGrid",className:"CalendarGrid",style:{boxShadow:r.a.depth16,padding:"0px"}},n.length>0?c.createElement("table",null,c.createElement("thead",null,c.createElement("tr",{key:"row0"},c.createElement("th",{key:"th1"},"Location"),n.map((function(e,t){return c.createElement("th",{key:t},c.createElement("div",null,e.DateString))})))),c.createElement("tbody",null,i.length>0&&c.createElement(c.Fragment,null,i.map((function(t,a){return c.createElement("tr",{key:"Lockey"+t.LocationId},c.createElement("td",{key:"col-loc"+t.LocationId},t.LocationName),t.CalData.map((function(a,n){return c.createElement("td",{key:"col-"+a.DayIndex+n,title:"No. of Activities: "+a.TotalInLocation},a.ShiftData&&c.createElement(y,{key:a.DayIndex,locationCapacity:t.LocationCapacity,location:t,locationId:t.LocationId,date:a.Date,shiftData:a.ShiftData,handleIconClick:e.handleShiftClick}))})))})),c.createElement(A,{TotalCountArr:f})))):this.loadSpinner("Processing Calendar",o)),o?c.createElement("div",null):c.createElement(c.Fragment,null,u?c.createElement("div",{className:"centeredContainer"},c.createElement(s.a,{size:d.a.large})):c.createElement("div",{className:"ActivityCards",style:{height:this.state.gridHeight}},p.length>0?c.createElement(S,{key:g,LocationsData:l,activityTilesArr:p,maxTilesPerRow:1,heading:h}):c.createElement(m.a,null,"Please click on the shift icon to get the details of the activities.")))))))}}]),a}(c.Component),j=(a(328),function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).props.handleRedirection("4"),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return c.createElement("div",{className:"ms-Grid CalendarMain",dir:"ltr"},c.createElement(L,null),c.createElement("div",{className:"ms-Grid-row ActivityCard"}))}}]),a}(c.Component))}}]);
//# sourceMappingURL=3.f5016bff.chunk.js.map