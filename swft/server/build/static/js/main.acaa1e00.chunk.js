(this.webpackJsonpswft=this.webpackJsonpswft||[]).push([[0],{102:function(e,t,i){"use strict";var a=i(6),n=i(8),o=i(12),r=i(11),s=i(0),c=i.n(s),l=i(168),d=i.n(l),m=(i(234),i(235),i(270)),u=i(269),p=i(65),h=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).handleDateSelect=function(e){if(console.log(e),e.length)n.setState({date:e}),n.props.updateFunc(e[0]);else{var t=new Date;n.setState({date:t}),n.props.updateFunc(t)}},n.state={date:null,viewForm:!1,isPast:!1,key:p()},n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dateInput,i=e.viewForm,a=e.isPast;t&&this.setState({date:t,viewForm:i,isPast:a})}},{key:"componentDidUpdate",value:function(e,t){var i=this.props,a=i.dateInput,n=i.viewForm,o=i.isPast;e.dateInput!==a&&this.setState({date:a,viewForm:n}),e.viewForm!==n&&this.setState({date:a,viewForm:n,key:p()}),e.isPast!==o&&this.setState({date:a,viewForm:n,isPast:o,key:p()})}},{key:"render",value:function(){var e=this.state,t=e.date,i=e.viewForm,a=e.isPast,n=this.props,o=n.labelHead,r=n.showNonFormLabel,s=n.required,l=a||i?{wrap:!0,enableTime:!1,dateFormat:"m/d/Y"}:{wrap:!0,enableTime:!1,minDate:"today",dateFormat:"m/d/Y"};return c.a.createElement("div",{className:"flatPickerDiv"},!r&&o&&c.a.createElement(u.a,{className:s&&"requiredLabel"},o),r&&o&&c.a.createElement("label",{className:s&&"requiredLabel"},o),c.a.createElement(d.a,{key:p(),value:t,options:l,className:i?"flatPickerClass viewFormDisabled":"flatPickerClass",onClose:this.handleDateSelect},c.a.createElement("input",{disabled:i,type:"text","data-input":!0,placeholder:"Select Date..",title:o}),i?"":c.a.createElement(m.a,{iconProps:{iconName:"Clear"},"data-clear":!0,disabled:i,title:"Clear",ariaLabel:"clear",onClick:this.handleDateSelect})))}}]),i}(s.Component);t.a=h},125:function(e,t,i){"use strict";var a=i(16),n={getLocationEquipmentData:function(){return new Promise((function(e,t){a.get("/api/Location/GetLocationEquipment").then((function(t){e(t.data)})).catch((function(e){console.log(e.response),t(e)}))}))}};t.a=n},132:function(e,t,i){"use strict";i.r(t),i.d(t,"Home",(function(){return h})),i.d(t,"PlanActivity",(function(){return Ke})),i.d(t,"PlanOfficeSpace",(function(){return We})),i.d(t,"MyActivites",(function(){return mt})),i.d(t,"PlanExperiment",(function(){return St}));var a=i(6),n=i(8),o=i(12),r=i(11),s=i(0),c=i.n(s),l=(i(211),i(212),{HeaderText:"<div>Welcome to SWFT. Please use this tool to plan all your lab and office activities.</div><div>If you need help, please try the help guides and videos on the right. If you are still having problems then please <a href='https://forms.office.com/Pages/ResponsePage.aspx?id=DpvWqfKXUkmc7miDkuQ4tN7XxzwPpIZImNnRJywlQoBURVYxTkJKUlRaRkxDS1VMM01UVEpGNFpSNS4u' target='_blank'>submit a helpdesk ticket.</a></div>",ActionLinks:[[{Text:"Plan an Experiment",Icon:"",Tooltip:"",RedirectURI:"/PlanExperiment",RedirectKey:"1"},{Text:"Plan Lab Activity",Icon:"",Tooltip:"",RedirectURI:"/PlanActivity",RedirectKey:"2"},{Text:"Plan Office Usage",Icon:"",Tooltip:"",RedirectURI:"/PlanOfficeSpace",RedirectKey:"3"}],[{Text:"View Calendar",Icon:"",Tooltip:"",RedirectURI:"/Calendar",RedirectKey:"4"},{Text:"View My Activities",Icon:"",Tooltip:"",RedirectURI:"/MyActivities",RedirectKey:"5"},{Text:"View Lab Today",Icon:"PowerBILogo",Tooltip:"Redirects to Power BI",RedirectURI:"",RedirectKey:""},{Text:"View Near Term Report",Icon:"PowerBILogo",Tooltip:"Redirects to Power BI",RedirectURI:"",RedirectKey:""}]],GuideLinks:[{Text:"Introduction to SWFT",Icon:"PDF",Tooltip:"",RedirectURI:"",RedirectKey:""},{Text:"Quick Overview",Icon:"MyMoviesTV",Tooltip:"",RedirectURI:"",RedirectKey:""},{Text:"Plan an Experiment",Icon:"MyMoviesTV",Tooltip:"",RedirectURI:"",RedirectKey:""},{Text:"Plan Lab Activity",Icon:"MyMoviesTV",Tooltip:"",RedirectURI:"",RedirectKey:""},{Text:"Plan Office Usage",Icon:"MyMoviesTV",Tooltip:"",RedirectURI:"",RedirectKey:""},{Text:"Clone an Experiment or Activity",Icon:"MyMoviesTV",Tooltip:"",RedirectURI:"",RedirectKey:""}]}),d=i(24),m=i(78),u=i(163),p=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(){var e;Object(a.a)(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).handleSelection=function(t,i){i.preventDefault(),t.RedirectKey||window.open(t.RedirectURI,"_blank"),e.props.handlePageTileClick(t)},e}return Object(n.a)(i,[{key:"render",value:function(){var e=this,t=this.props.link,i=t.RedirectURI?"ms-Grid PageTile":"ms-Grid PageTile disabledHomeBtn";return s.createElement("div",{className:i,title:t.Tooltip,onClick:function(i){return e.handleSelection(t,i)},style:{boxShadow:m.a.depth16,minHeight:"65px",border:"solid 2px gray"}},s.createElement("div",{className:"ms-Grid-row",style:{width:"100%"}},s.createElement("div",{className:"ms-Grid-col ms-sm4 ms-md4 ms-lg4",style:{textAlign:"center"}},t.Icon?s.createElement(u.a,{iconName:t.Icon,style:{paddingLeft:"20px",fontSize:"1.7em",verticalAlign:"bottom",color:"#EDBD11"}}):""),s.createElement("div",{className:"ms-Grid-col ms-sm8 ms-md8 ms-lg8"},t.Text)))}}]),i}(s.Component),h=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).handlePageTileClick=function(e){n.setState({shouldRedirect:""!=e.RedirectKey,redirectURI:e.RedirectURI}),n.props.handleRedirection(e.RedirectKey)},n.getHomePageConfig=function(){try{var e=JSON.parse(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_AAD_CLIENT_ID:"3e54e1d2-906c-4113-8638-d49c6dbbbb13",REACT_APP_AAD_TENANT_ID:"ecfe8182-3217-4e0b-9fb1-f8ad05aaca36",REACT_APP_APPLICATION_NAME:"SWFT - Obsidian"}).REACT_APP_HOME_PAGE_CONFIG?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_AAD_CLIENT_ID:"3e54e1d2-906c-4113-8638-d49c6dbbbb13",REACT_APP_AAD_TENANT_ID:"ecfe8182-3217-4e0b-9fb1-f8ad05aaca36",REACT_APP_APPLICATION_NAME:"SWFT - Obsidian"}).REACT_APP_HOME_PAGE_CONFIG:"");return e||l}catch(t){return console.log(t),l}},n.state={shouldRedirect:!1,redirectURI:"/Home"},n.props.handleRedirection("0"),n}return Object(n.a)(i,[{key:"render",value:function(){var e,t=this,i=this.state,a=i.shouldRedirect,n=i.redirectURI,o=this.getHomePageConfig(),r=12/(null===(e=o.ActionLinks)||void 0===e?void 0:e.length),c="ms-Grid-col ms-sm12 ms-md".concat(r," ms-lg").concat(r);return s.createElement("div",{className:"ms-Grid Home",dir:"ltr"},s.createElement("div",{className:"ms-Grid-row",style:{textAlign:"left",paddingTop:"20px"}},o.HeaderText&&s.createElement("div",{className:"ms-Grid-col ms-sm12",style:{fontSize:"14pt",paddingTop:"10px"},dangerouslySetInnerHTML:{__html:o.HeaderText}})),s.createElement("div",{className:"ms-Grid-row",style:{paddingTop:"50px"}},s.createElement("div",{className:"ms-Grid-col ms-sm12 ms-md7 ms-lg7"},s.createElement("div",{className:"ms-Grid"},s.createElement("div",{className:"ms-Grid-row"},o.ActionLinks.map((function(e,i){return s.createElement("div",{className:c},e.map((function(e,i){return s.createElement(p,{key:i,link:e,handlePageTileClick:t.handlePageTileClick})})))}))))),s.createElement("div",{className:"ms-Grid-col ms-sm12 ms-md2 ms-lg2"},s.createElement("div",{style:{width:"50%",borderRight:"solid 5px gray",minHeight:"430px",marginTop:"7px"}})),s.createElement("div",{className:"ms-Grid-col ms-sm12 ms-md3 ms-lg3"},o.GuideLinks.map((function(e,i){return s.createElement(p,{link:e,handlePageTileClick:t.handlePageTileClick})})))),a?s.createElement(d.a,{to:n}):"")}}]),i}(s.Component),v=i(45),f=i(47),g=i(322),E=i(14),y=i(314),A=i(268),S=i(49),D=i(9),x=i.n(D),N=i(5);function C(e){return c.a.createElement("div",{className:"FormWrapper",style:{boxShadow:m.a.depth4}},c.a.createElement("div",{className:"formSection"},c.a.createElement("div",{className:"sectionContainer"},c.a.createElement("div",{className:"subHeading"},c.a.createElement("div",{style:{fontSize:"12pt",fontWeight:"bold"}},e.FormHeading)),c.a.createElement("div",{className:"FormBody"},e.children))))}i(147),i(148);var I=i(97),b=i(125),w=i(16),k=i(21);function F(e,t){var i={};try{if(i.ActivityName=e.activityName,i.ActivityDescription=e.activityDescription,i.DayOffset=t===N.a.ActivityForm.OfcAndIndiActivityType?0:e.DayOffset,i.ActivityDate=e.activityDate?k(e.activityDate).format(N.a.ActivityForm.AtivityDateFormat):"",i.ShiftIds=e.selectedShiftIds,i.BookedByName=e.bookedByEmail.DisplayName,i.BookedByEmail=e.bookedByEmail.Email,i.IsEmployee=!e.showVisitorField,e.showVisitorField)i.BookedForEmail=e.visitorEmail,i.BookedForName=e.visitorEmail.split("@")[0];else{if(!(e.bookedForEmail.length>0))return!1;i.BookedForName=e.bookedForEmail[0].DisplayName,i.BookedForEmail=e.bookedForEmail[0].Email}if(i.LocationIds=e.selectedLocations,i.EquipmentIds=e.selectedEquipments,i.ExperimentId=e.ExperimentId?e.ExperimentId:null,e.ExperimentId){var a=k(e.ExperimentStartDate),n=k(e.activityDate),o=Math.ceil(n.diff(a,"days"));i.DayOffset=o}}catch(r){console.log(r),i=!1}return i}var T={cloneActivity:function(e){return new Promise((function(t,i){w.post("/api/Activity/Clone",e).then((function(e){t(e.data)})).catch((function(e){console.log(e.response),i(e)}))}))},getActivityById:function(e){return new Promise((function(t,i){w.get("/api/Activity/".concat(e)).then((function(e){t(e.data)})).catch((function(e){console.log(e.response),i(e)}))}))},deleteActivityRecordById:function(e,t){return new Promise((function(i,a){var n=function(e,t){var i={};try{i.ActivityId=e,i.ExperimentId=0,i.Notes=t}catch(a){console.log(a),i=!1}return i}(e,t);if(!n){a("Error in processing Data. Activity Date not found")}w.put("/api/Activity/Delete",{jsonObj:n}).then((function(e){i(e.data)})).catch((function(e){console.log(e.response),a(e)}))}))},createActivityRecord:function(e,t){return new Promise((function(i,a){var n=F(e,t);if(n)n.Notes="Creation of activity by "+n.BookedByName+" for "+n.BookedForName+" on "+n.ActivityDate;else{a("Error in processing Data. Activity Date not found")}w.post("/api/Activity",{jsonObj:n}).then((function(e){i(e.data)})).catch((function(e){console.log(e.response),a(e)}))}))},updateActivityRecord:function(e,t,i){return new Promise((function(a,n){var o=F(e,t);if(o)o.Id=e.Id,o.Notes=i;else{n("Error in processing Data. Activity Date not found")}w.put("/api/Activity",{jsonObj:o}).then((function(e){a(e.data)})).catch((function(e){console.log(e.response),n(e)}))}))},CloneIndividualActivity:function(e){return new Promise((function(t,i){w.post("/api/Activity/Clone",e).then((function(e){t(e.data)})).catch((function(e){console.log(e),i(e)}))}))}},L=i(21);function O(e){var t={};return t.Id=e.Id,t.Name=e.Name,t.Description=e.Description,t.ProjectId=e.ProjectId,t.Remarks=e.Remarks,t.Owner=e.Owner,t.StatusId=1,t.UpdateActivities=e.UpdateActivities,t.StartDate=e.StartDate?L(e.StartDate).format(N.a.PlanExperiment.ExpDateFormat):"",t}var M={getProjects:function(){return new Promise((function(e,t){w.get("/api/Experiment/GetProjects").then((function(t){e(t)})).catch((function(e){console.log(e),t(e)}))}))},addExperiment:function(e){return new Promise((function(t,i){w.post("/api/Experiment/Add",O(e)).then((function(e){t(e.data)})).catch((function(e){console.log(e),i(e)}))}))},updateExperiment:function(e){return new Promise((function(t,i){w.post("/api/Experiment/Update",O(e)).then((function(e){t(e.data.recordsets)})).catch((function(e){console.log(e),i(e)}))}))},getExperiment:function(e){return new Promise((function(t,i){w.get("/api/Experiment/".concat(e)).then((function(e){var i=e.data.recordset.length>0?e.data.recordset[0]:null;if(i){var a=i.StartDate?new Date(L.utc(i.StartDate).format(N.a.DateFormats.NoTimeDate)):null,n={Id:i.Id,Name:i.Name,StartDate:a||null,Description:i.Description,StatusId:i.StatusId,Remarks:i.Remarks,ProjectId:i.ProjectId,Owner:[{Email:i.Owner,DisplayName:i.OwnerName}]};t(n)}else t(null)})).catch((function(e){console.log(e),i(e)}))}))},getActivitiesForExp:function(e){return new Promise((function(t,i){w.get("/api/Experiment/".concat(e,"/activities")).then((function(e){t(e.data)})).catch((function(e){console.log(e),i(e)}))}))},deleteExperiment:function(e,t){return new Promise((function(i,a){w.post("/api/Experiment/Delete",{ExperimentId:e,Notes:t}).then((function(e){i(e.data)})).catch((function(e){console.log(e),a(e)}))}))},deleteActivities:function(e){return new Promise((function(t,i){w.post("/api/Experiment/activities/delete",e).then((function(e){t(e.data)})).catch((function(e){console.log(e),i(e)}))}))},cloneExperiment:function(e){return new Promise((function(t,i){w.post("/api/Experiment/Clone",{ExperimentId:e}).then((function(e){t(e.data.output)})).catch((function(e){console.log(e),i(e)}))}))},CloneActivity:function(e){return new Promise((function(t,i){w.post("/api/Activity/Clone",e).then((function(e){t(e.data)})).catch((function(e){console.log(e),i(e)}))}))}},P=i(21);function R(e){return e?P(e).format(N.a.ActivityForm.AtivityDateFormat):P().format(N.a.ActivityForm.AtivityDateFormat)}function B(e){return e?P.utc(e).format(N.a.DateFormats.NoTimeDate):null}function U(e,t){var i=[];return t||i.push(N.a.ActivityForm.officeSpaceUsageLocation),D.filter(e,(function(e){if(-1===i.indexOf(e.LocationId)){i.push(e.LocationId);var t={};return t.LocationId=e.LocationId,t.LocationName=e.LocationName,t.LocationDescription=e.LocationDescription,t.LocationCapacity=e.LocationCapacity,t}}))}function j(){return new Promise((function(e,t){I.a.getShiftsData().then((function(t){return e(t)})).catch((function(e){t(e)}))}))}function _(){return new Promise((function(e,t){b.a.getLocationEquipmentData().then((function(t){return e(t)})).catch((function(e){t(e)}))}))}function q(e){return new Promise((function(t,i){T.getActivityById(e).then((function(e){return t(e)})).catch((function(e){i(e)}))}))}function H(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}var G=i(321),V=(i(232),i(65)),K=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).reduceLSAByLocations=function(e,t){var i=x.a.orderBy(Object(f.a)(e),["LocationName","ShiftName"]),a=[];return x.a.forEach(i,(function(e,t){var i=a.filter((function(t){return t.LocationId===e.LocationId}));if(0===i.length){var n=Object.assign({},{LocationId:e.LocationId,LocationName:e.LocationName,LocationDescription:e.LocationDescription});x.a.set(n,"status-"+e.ShiftId,e.Status),x.a.set(n,"count-"+e.ShiftId,e.NoOfActivities),x.a.set(n,"color-"+e.ShiftId,e.IndicationColor),a.push(n)}else{var o=i[0];x.a.set(o,"status-"+e.ShiftId,e.Status),x.a.set(o,"count-"+e.ShiftId,e.NoOfActivities),x.a.set(o,"color-"+e.ShiftId,e.IndicationColor)}})),a},n.state={isLoaded:!1,selectedDate:new Date(R()),shiftLocationDataArr:[],errorMsg:"",showErrorMsg:!1},n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this.props.activityDate;this.setState({selectedDate:e}),this.callForShiftLocationAvailabilityData(e)}},{key:"callForShiftLocationAvailabilityData",value:function(e){var t,i=this,a=this.props,n=a.Locations,o=a.Shifts;(t={activityDate:e},new Promise((function(e,i){I.a.getShiftLocationAvaliability(t).then((function(t){return e(t)})).catch((function(e){i(e)}))}))).then((function(e){if(e){var t=function(e,t,i,a){for(var n=[],o=0;o<e.length;o++){var r=e[o],s={};s.LocationId=r.LocationId,s.LocationName=r.LocationName,s.LocationDescription=r.LocationDescription,s.LocationCapacity=r.LocationCapacity;for(var c=0;c<t.length;c++){var l=t[c];if(s.ShiftId=l.Id,s.ShiftName=l.Name,s.ShiftStartHour=l.StartHour,s.ShiftStartMin=l.StartMin,s.ShiftEndHour=l.EndHour,s.ShiftEndMin=l.EndMin,s.ShiftDisplayName=l.DisplayName,i.length>0){var d=D.filter(i,{ShiftId:l.Id,LocationId:r.LocationId});if(d.length>0){var m;m=D.map(d,"BookedForEmail");var u=D.uniq(m);l.Id===N.a.ActivityForm.TBDRejectShiftId?(s.NoOfActivities=u.length,s.Status=u.length+"/?",s.IndicationColor="Green",s.OnAlert=!1):(s.NoOfActivities=u.length,s.Status=u.length+"/"+r.LocationCapacity,s.IndicationColor=u.length>=r.LocationCapacity?"Red":"Green",s.OnAlert=u.length>=r.LocationCapacity)}else l.Id===N.a.ActivityForm.TBDRejectShiftId?(s.NoOfActivities=0,s.Status="0/?",s.IndicationColor="Green",s.OnAlert=!1):(s.NoOfActivities=0,s.Status="0/"+r.LocationCapacity,s.IndicationColor="Green",s.OnAlert=!1)}else l.Id===N.a.ActivityForm.TBDRejectShiftId?s.Status="0/?":s.Status="0/"+r.LocationCapacity,s.IndicationColor="Green";a?s.LocationId===N.a.ActivityForm.officeSpaceUsageLocation&&n.push(JSON.parse(JSON.stringify(s))):n.push(JSON.parse(JSON.stringify(s)))}}return D.orderBy(n,"ShiftName")}(n,o,e,i.props.office);i.setState({shiftLocationDataArr:t,isLoaded:!0}),i.props.sendLsaArr(t)}else i.setState({isLoaded:!0,showErrorMsg:!0,errorMsg:N.a.ActivityForm.ErrorLSADataFetchMessage}),console.log("No Shift Location Availabilities")})).catch((function(e){i.setState({isLoaded:!0,showErrorMsg:!0,errorMsg:N.a.ActivityForm.ErrorLSADataFetchMessage}),console.log(e)}))}},{key:"componentDidUpdate",value:function(e,t){var i=this.props.activityDate;e.activityDate!==i&&(this.setState({isLoaded:!1}),this.callForShiftLocationAvailabilityData(i))}},{key:"renderErrorMsg",value:function(e){return s.createElement(g.a,{messageBarType:E.a.error},e)}},{key:"render",value:function(){var e=this,t=this.state,i=t.isLoaded,a=t.shiftLocationDataArr,n=t.showErrorMsg,o=t.errorMsg,r=this.reduceLSAByLocations(a,this.props.Shifts),c=x.a.orderBy(Object(f.a)(this.props.Shifts),["Name"]);return s.createElement("div",{className:"LocationShiftAvailability"},i?n?this.renderErrorMsg(o):s.createElement("div",null,0===a.length?s.createElement(s.Fragment,null,s.createElement(g.a,null,"No Activities for the day!.",s.createElement(G.a,{iconName:"Emoji2",className:"iconPadClasss"}))):s.createElement("table",{className:"stickyTable"},s.createElement("thead",null,s.createElement("tr",{key:"row0"},s.createElement("th",{key:"loc0"},"Location"),c.map((function(e){return s.createElement("th",{key:"shift"+e.Id},e.Name)})))),s.createElement("tbody",null,r.map((function(t,i){return s.createElement("tr",{key:V()},s.createElement("td",{key:"loc"+t.LocationId,title:t.LocationDescription},t.LocationName),c.map((function(a){return s.createElement("td",{key:"shift"+a.Id+i,className:"rowColor"+x.a.get(t,"color-"+a.Id)},e.props.office?x.a.get(t,"count-"+a.Id):x.a.get(t,"status-"+a.Id))})))}))))):s.createElement(s.Fragment,null,s.createElement("div",{className:"sectionSpinner"},s.createElement(A.a,{size:S.a.large,label:"Loading..."}))))}}]),i}(s.Component),W=i(102),Y=(i(236),i(269)),z=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).handleSelection=function(e){var t=e.currentTarget.dataset,i=parseInt(t.cusindex),a=n.state.arrayInput;a[i].isSelected="false"===t.selected,n.setState({arrayInput:a}),n.props.handleChangeFunction(a)},n.renderSwithcSelector=function(e){var t=n.props.viewForm;return s.createElement("div",{className:"SwitchSelector",key:e.length},e.map((function(e,i){return s.createElement("div",{className:t?"viewFormDisabled":"",key:i+e.Id,"data-cusindex":i,"data-selected":e.isSelected,onClick:function(e){n.handleSelection(e)}},s.createElement("div",{className:e.isSelected?"switch switchSelected":"switch",title:e.DisplayName},e.DisplayName))})))},n.state={arrayInput:[]},n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this.props.arrayInput;this.setState({arrayInput:e})}},{key:"componentDidUpdate",value:function(e,t){var i=this.props.arrayInput;e.arrayInput.length!==i.length&&this.setState({arrayInput:i})}},{key:"render",value:function(){var e=this.props,t=e.labelHead,i=e.required,a=this.state.arrayInput;return s.createElement("div",null,t&&s.createElement(Y.a,{className:i?"requiredLabel":""},t),this.renderSwithcSelector(a))}}]),i}(s.Component),J=i(21),Z=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).getOffsetValue=function(e,t){var i=J(e),a=J(t);return Math.ceil(i.diff(a,"days",!0))},n.handleDateSelectChange=function(e){var t=n.state,i=t.activityDate,a=t.ExpDate;if(e&&R(e)!=R(i)){var o=n.getOffsetValue(e,a);n.setState({activityDate:e,Offset:o})}n.props.handleFormFieldChange(e,"activityDate")},n.handleShiftSelection=function(e){var t=D.map(D.filter(e,{isSelected:!0}),"Id");n.setState({shiftTimmings:e,selectedShiftIds:t}),n.props.handleFormFieldChange(t,"selectedShiftIds")},n.state={shiftTimmings:[],selectedShiftIds:[],activityDate:new Date(R()),errorMsgs:{},Offset:0,ExpDate:null},n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this.props,t=e.shiftTimmings,i=e.errorMsgs,a=e.activityDate,n=e.selectedShiftIds,o=e.ExpDate,r=J(o),s=J(a).diff(r,"days");this.setState({shiftTimmings:t,activityDate:a,selectedShiftIds:n,errorMsgs:i,ExpDate:o,Offset:s})}},{key:"componentDidUpdate",value:function(e,t){var i=this.props,a=i.shiftTimmings,n=i.errorMsgs,o=i.activityDate,r=i.ExpDate,s=i.selectedShiftIds;if(e.shiftTimmings.length!=a.length&&this.setState({shiftTimmings:a}),e.activityDate!=o&&this.setState({activityDate:o}),e.selectedShiftIds.length!=s.length&&this.setState({selectedShiftIds:s}),n.activityDate===e.errorMsgs.activityDate&&n.selectedShiftIds===e.errorMsgs.selectedShiftIds||this.setState({errorMsgs:n}),r&&e.ExpDate){var c=J(e.ExpDate);if(0!==J(r).diff(c,"days",!0)){var l=this.getOffsetValue(o,r);this.setState({Offset:l,ExpDate:r})}}if(r&&e.ExpDate){var d=J(e.activityDate);if(0!==J(o).diff(d,"days",!0)){var m=this.getOffsetValue(o,r);this.setState({Offset:m,ExpDate:r})}}}},{key:"renderErrorMsgForField",value:function(e,t){return s.createElement("div",{role:"alert",key:t},s.createElement("p",{className:"ms-TextField-errorMessage alertMsg"},s.createElement("span",{"data-automation-id":"error-message"},e)))}},{key:"render",value:function(){var e=this.state,t=e.shiftTimmings,i=e.errorMsgs,a=e.activityDate,n=e.Offset,o=this.props,r=o.viewForm,c=o.ExpId;return s.createElement("div",{className:"ms-Grid-row",style:{display:"flex",alignItems:"flex-end"}},s.createElement("div",{className:"ms-Grid-col ms-sm3"},s.createElement(W.a,{required:!0,viewForm:r,labelHead:"Activity Date",updateFunc:this.handleDateSelectChange,dateInput:a}),i.activityDate?this.renderErrorMsgForField(i.activityDate,"activityDateError"):""),c&&s.createElement("div",{className:"ms-Grid-col ms-sm1",style:{marginBottom:"5px"}},n&&n<0?"Error: NA":"T + "+n),s.createElement("div",{className:c?"ms-Grid-col ms-sm8":"ms-Grid-col ms-sm9"},t.length>0?s.createElement(z,{viewForm:r,labelHead:"Activity Shift",required:!0,arrayInput:t,handleChangeFunction:this.handleShiftSelection}):s.createElement(g.a,{messageBarType:E.a.error,className:"errorMsgInfo"},N.a.ActivityForm.NoShiftsErrorMsg),i.selectedShiftIds?this.renderErrorMsgForField(i.selectedShiftIds,"selectedShiftIdsError"):""))}}]),i}(s.Component),Q=i(320),$=i(3),X=i.n($),ee=i(57),te=i(309),ie=i(310),ae=i(4),ne=i(75),oe=i(54),re={root:{width:"100%"}},se=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(){var e;Object(a.a)(this,i),(e=t.call(this)).getInitials=function(e){var t=e.substring(0,1);try{var i=e.split(" ");i.length>0&&(t=i[0].substring(0,1)+i[i.length-1].substring(0,1))}catch(a){console.log(a)}return t},e._peopleList=null,e._searchResults=[];var n=oe.a.getCacheItem("accountInfo"),o={},r="";try{r=(o=JSON.parse(n.value)).jwtAccessToken?o.jwtAccessToken:Object(ne.a)()}catch(s){console.log("account Info error",s)}return e.state={selectedPeople:[],isLoadingPeople:!0,isLoadingPics:!0,accessToken:r},e}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this.props.selectedPeople;this.setState({selectedPeople:this._mapUsersToPersonas(e,!0)})}},{key:"_mapUsersToPersonas",value:function(e,t){var i=this;return e.map((function(e){var a=t?e.mail:e.scoredEmailAddresses[0].address,n=new ie.a;return n.text=e.displayName,n.secondaryText=a||e.userPrincipalName,n.presence=ae.b.none,n.imageInitials=e.givenName&&e.surname?e.givenName.substring(0,1)+e.surname.substring(0,1):i.getInitials(e.displayName),n.initialsColor=Math.floor(15*Math.random())+0,n.props={id:e.id,userPrincipalName:e.userPrincipalName},n}))}},{key:"_getPics",value:function(){var e=Object(ee.a)(X.a.mark((function e(t){var i=this;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({isLoadingPeople:!1}),Object(ne.c)(t,this.state.accessToken).then().catch((function(e){console.log(e),i.setState({isLoadingPics:!1})}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_onFilterChanged",value:function(e,t){var i=this;return this._peopleList?(this.setState({isLoadingPeople:!1}),e?this._peopleList.concat(this._searchResults).filter((function(t){return 0===t.text.toLowerCase().indexOf(e.toLowerCase())})).filter((function(e){return!i._listContainsPersona(e,t)})):[]):new Promise((function(e){return Object(ne.b)(i.state.accessToken).then((function(t){i._peopleList=i._mapUsersToPersonas(t,!1),i.setState({isLoadingPeople:!1}),e(i._peopleList)})).catch((function(){}))})).then((function(a){return a.concat(i._searchResults).filter((function(t){return 0===t.text.toLowerCase().indexOf(e.toLowerCase())})).filter((function(e){return!i._listContainsPersona(e,t)}))}))}},{key:"_listContainsPersona",value:function(e,t){return!(!t||!t.length||0===t.length)&&t.filter((function(t){return t.text===e.text})).length>0}},{key:"_onGetMoreResults",value:function(e){var t=this;if(this.setState({isLoadingPeople:!1,isLoadingPics:!0}),0!==e.length)return new Promise((function(i){Object(ne.d)(e.toLowerCase(),t.state.accessToken).then((function(e){t._searchResults=t._mapUsersToPersonas(e,!0),t.setState({isLoadingPeople:!1}),i(t._searchResults)})).catch((function(e){console.log(e)}))}))}},{key:"_onSelectionChanged",value:function(e){this.setState({result:null,selectedPeople:e}),this.props.updateSelection(e)}},{key:"render",value:function(){var e=this.props,t=e.placeholderTxt,i=e.disabled;e.description;return c.a.createElement(c.a.Fragment,null,c.a.createElement(te.a,{onResolveSuggestions:this._onFilterChanged.bind(this),pickerSuggestionsProps:{suggestionsHeaderText:"Suggested People",noResultsFoundText:"No results found",searchForMoreText:"Search",searchingText:"Searching more...",loadingText:"Loading...",isLoading:this.state.isLoadingPeople},inputProps:{placeholder:t},itemLimit:1,selectedItems:this.state.selectedPeople,getTextFromItem:function(e){return e.text},onChange:this._onSelectionChanged.bind(this),onGetMoreResults:this._onGetMoreResults.bind(this),key:"normal-people-picker",styles:re,disabled:i}))}}]),i}(s.Component);function ce(e){var t={},i=[],a=[],n=0,o=0;try{if(e){for(o=e.length,n=0;n<o;n++){var r=e[n];if(t={},r.Email&&-1===i.indexOf(r.Email))try{var s=r.UserLogin;t.userPrincipalName=s,t.displayName=r.DisplayName,t.mail=r.Email,t.id=n+r.Email,i.push(r.Email),a.push(t)}catch(c){console.log(c)}}return a}return a}catch(c){return console.log(c),a}}var le=i(65),de=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).updateSelection=function(e){n.setState({selectedPeople:e}),n.handleAddClick(e)},n.handleAddClick=function(e){var t;t=function(e){var t={},i=[],a=[],n=0,o=0;try{if(e){for(o=e.length,n=0;n<o;n++){var r=e[n];if(t={},r.secondaryText&&-1===i.indexOf(r.secondaryText))try{var s=r.props.userPrincipalName;t.UserLogin=s||r.secondaryText,t.DisplayName=r.text,t.Email=r.secondaryText,i.push(r.secondaryText),a.push(t)}catch(c){console.log(c)}}return a}return a}catch(c){return console.log(c),a}}(e),n.props.updatePeoplePickerChange(t,n.props.property)},n.state={selectedPeople:[],pickrKey:le()},n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e;e=ce(this.props.people),this.setState({selectedPeople:e,pickrKey:le()})}},{key:"componentDidUpdate",value:function(e,t){var i,a=this.props.people;i=ce(a),e.people.length!==a.length&&this.setState({selectedPeople:i,pickrKey:le()})}},{key:"render",value:function(){var e=this.state,t=e.selectedPeople,i=e.pickrKey,a=this.props,n=a.viewForm,o=a.description;return s.createElement("div",{style:n?{border:"1px solid"}:{}},s.createElement(se,{disabled:n,required:!0,description:o,placeholderTxt:this.props.placeholderTxt,key:i,updateSelection:this.updateSelection,selectedPeople:t}))}}]),i}(s.Component),me={wrapper:{width:"100%",display:"block",selectors:{disabled:{color:"black"}}},root:{width:"100%"},subComponentStyles:{label:{color:"black!important"}}},ue={container:{marginTop:"4px"}},pe=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).handleToggleChange=function(e){var t={target:{value:e.target.value,name:"showVisitorField"}},i=n.state.showVisitorField;t.target.value=!i,n.setState({visitorEmail:"",showVisitorField:!i}),n.props.handleOnChange(t)},n.handleOnChange=function(e){var t=e.target.value,i=e.target.name,a={target:{value:t,name:i}};switch(i){case"activityName":n.setState({activityName:t});break;case"visitorEmail":n.setState({visitorEmail:t})}n.props.handleOnChange(a)},n.updateBookedForEmail=function(e,t){var i={target:{value:e,name:t,selectedFor:e}};n.setState({selectedFor:e}),n.props.handleOnChange(i)},n.state={activityName:"",showVisitorField:!1,errorMsgs:{},visitorEmail:"",selectedFor:[]},n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this.props,t=e.activityName,i=e.showVisitorField,a=e.errorMsgs,n=e.visitorEmail,o=e.selectedFor;this.setState({activityName:t,showVisitorField:i,visitorEmail:n,errorMsgs:a,selectedFor:o})}},{key:"componentDidUpdate",value:function(e,t){var i=this.props.errorMsgs;i.activityName!==e.errorMsgs.activityName&&this.setState({errorMsgs:i}),i.visitorEmail!==e.errorMsgs.visitorEmail&&this.setState({errorMsgs:i}),i.bookedForEmail!==e.errorMsgs.bookedForEmail&&this.setState({errorMsgs:i}),i.bookedForEmail!==e.errorMsgs.bookedForEmail&&this.setState({errorMsgs:i})}},{key:"renderErrorMsgForField",value:function(e,t){return s.createElement("div",{role:"alert",key:t},s.createElement("p",{className:"ms-TextField-errorMessage alertMsg"},s.createElement("span",{"data-automation-id":"error-message"},e)))}},{key:"render",value:function(){var e=this.state,t=e.activityName,i=e.showVisitorField,a=e.errorMsgs,n=e.visitorEmail,o=e.selectedFor,r=this.props.viewForm;return s.createElement("div",{className:"ms-Grid-row"},s.createElement("div",{className:"ms-Grid-col ms-sm5"},s.createElement(y.a,{label:"Activity Name",required:!0,disabled:r,name:"activityName",placeholder:"Activity Name",value:t,errorMessage:a.activityName,onChange:this.handleOnChange,styles:me})),s.createElement("div",{className:"ms-Grid-col ms-sm7"},s.createElement("div",{className:"ms-Grid-row"},s.createElement("div",{className:"ms-Grid-col ms-sm2"},s.createElement(Q.a,{disabled:r,label:"Visitor?",onText:"Yes",offText:"No",checked:i,styles:ue,onChange:this.handleToggleChange})),s.createElement("div",{className:"ms-Grid-col ms-sm10"},i?s.createElement(s.Fragment,null,s.createElement(y.a,{disabled:r,label:"Visitor Email",required:!0,name:"visitorEmail",placeholder:"Visitor Email",value:n,errorMessage:a.visitorEmail,onChange:this.handleOnChange,styles:me})):s.createElement(s.Fragment,null,s.createElement(Y.a,{className:"requiredLabel"},"Person Name"),s.createElement("div",{style:{backgroundColor:"#fff"}},s.createElement(de,{viewForm:r,required:!0,description:"Toggle Vistor field to if personis a visitor",placeholderTxt:"Person Name",property:"bookedForEmail",updatePeoplePickerChange:this.updateBookedForEmail,people:o})),a.bookedForEmail?this.renderErrorMsgForField(a.bookedForEmail,"bookedForEmailError"):"")))))}}]),i}(s.Component),he=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).getOptionsSelected=function(e){for(var t=[],i=0,a=e.length;i<a;i++)e[i].selected&&t.push(parseInt(e[i].id));return t},n.handleDropDownChange=function(e){var t=e.target.id,i=e.target.options,a=n.getOptionsSelected(i);n.setState({selectedEquipments:a}),n.props.handleEquipmentSelectionChange(a,t)},n.handleLocationDropDownChange=function(e){e.target.id;var t=e.target.options,i=[],a=n.getOptionsSelected(t),o=n.state,r=o.selectedEquipments,s=o.Equipments;if(r.length>0){var c;c=D.filter(s,(function(e){if(-1!==a.indexOf(e.LocationId)&&e.EquipmentId)return e.EquipmentId}));var l=D.map(c,"EquipmentId");i=D.reject(r,(function(e){if(-1===l.indexOf(e))return!0})),n.setState({selectedLocations:a,selectedEquipments:i})}else n.setState({selectedLocations:a,selectedEquipments:[]});n.props.handleLocationSelectionChange(a,i)},n.renderEquipments=function(e,t){if(e.length>0&&t.length){var i=n.state.selectedEquipments;return D.filter(e,(function(e){if(-1!==t.indexOf(e.LocationId)&&e)return e})).map((function(e,t){var a,n;return i&&e.EquipmentId&&-1!==i.indexOf(e.EquipmentId)?c.a.createElement("option",{id:null===(a=e.EquipmentId)||void 0===a?void 0:a.toString(),value:e.EquipmentName,selected:!0,key:t+e.EquipmentName},e.EquipmentName):e.EquipmentId?c.a.createElement("option",{id:null===(n=e.EquipmentId)||void 0===n?void 0:n.toString(),value:e.EquipmentName,key:t+e.EquipmentName},e.EquipmentName):void 0}))}return c.a.createElement("option",{value:0,disabled:!0},"Please select Location to populate Equipments")},n.renderLocations=function(e,t){return e.map((function(e,i){var a,n;return-1!==t.indexOf(e.LocationId)?c.a.createElement("option",{id:null===(a=e.LocationId)||void 0===a?void 0:a.toString(),key:i+e.LocationName,value:e.LocationId,selected:!0},e.LocationName):c.a.createElement("option",{id:null===(n=e.LocationId)||void 0===n?void 0:n.toString(),key:i+e.LocationName,value:e.LocationId,selected:!1},e.LocationName)}))},n.state={Equipments:[],Locations:[],selectedLocations:[],selectedEquipments:[],locationEquipKey:"1"},n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this.props,t=e.Equipments,i=e.Locations,a=e.locationEquipKey,n=e.selectedLocations,o=e.selectedEquipments;this.setState({Equipments:t,Locations:i,selectedLocations:n,locationEquipKey:a,selectedEquipments:o})}},{key:"componentDidUpdate",value:function(e,t){var i=this.props,a=i.locationEquipKey,n=i.Equipments,o=i.Locations,r=i.selectedLocations,s=i.selectedEquipments;a!=e.locationEquipKey&&this.setState({locationEquipKey:a,Equipments:n,Locations:o,selectedLocations:r,selectedEquipments:s})}},{key:"renderErrorMsgForField",value:function(e,t){return c.a.createElement("div",{role:"alert",key:t},c.a.createElement("p",{className:"ms-TextField-errorMessage alertMsg"},c.a.createElement("span",{"data-automation-id":"error-message"},e)))}},{key:"render",value:function(){var e=this,t=this.props,i=t.errorMsgs,a=t.viewForm,n=this.state,o=n.Equipments,r=n.Locations,s=n.locationEquipKey,l=n.selectedLocations;n.selectedEquipments;return c.a.createElement("div",{className:"ms-Grid-row selectSection"},r.length>0?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"ms-Grid-col ms-sm4"},c.a.createElement(Y.a,{className:"requiredLabel"},"Select Location"),c.a.createElement("select",{disabled:a,id:"selectedLocations",multiple:!0,required:!0,onChange:function(t){return e.handleLocationDropDownChange(t)}},this.renderLocations(r,l)),i.selectedLocations?this.renderErrorMsgForField(i.selectedLocations,"selectedLocationsError"):""),c.a.createElement("div",{className:"ms-Grid-col ms-sm8"},c.a.createElement(Y.a,null,"Select Equipment"),c.a.createElement("select",{key:s,disabled:a,id:"selectedEquipments",multiple:!0,onChange:function(t){return e.handleDropDownChange(t)}},this.renderEquipments(o,l)))):c.a.createElement(g.a,{messageBarType:E.a.error,className:"errorMsgInfo"},N.a.ActivityForm.NoLocationEquipmentErrorMsg))}}]),i}(s.Component),ve=i(80),fe=i(44),ge=i(315),Ee={container:{display:"flex",flexFlow:"column nowrap",alignItems:"stretch",maxWidth:300}},ye=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).state={showModal:e.showModal},n}return Object(n.a)(i,[{key:"render",value:function(){return c.a.createElement("div",{className:"model"},c.a.createElement(ge.a,{isOpen:this.state.showModal,onDismiss:this._closeModal,containerClassName:Ee,dragOptions:void 0,isBlocking:!0},this.props.children))}}]),i}(s.Component),Ae=i(306),Se=(i(241),function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).getIcon=function(){switch(n.props.actionType){case"Update":return s.createElement(G.a,{iconName:"CompletedSolid",className:"actionIcon greenIcon"});case"Nothing":return s.createElement(G.a,{iconName:"IncidentTriangle",className:"actionIcon"});case"Failed":return s.createElement(G.a,{iconName:"StatusErrorFull",className:"actionIcon redIcon"});case"Denied":return s.createElement(G.a,{iconName:"Blocked2Solid",className:"actionIcon redIcon"});case"Delete":return s.createElement(G.a,{iconName:"Delete",className:"actionIcon themeIcon"});case"Create":return s.createElement(G.a,{iconName:"CompletedSolid",className:"actionIcon greenIcon"});case"Clone":return s.createElement(G.a,{iconName:"Copy",className:"actionIcon themeIcon"});default:return s.createElement(G.a,{iconName:"StatusErrorFull",className:"actionIcon redIcon"})}},n.handlRedirectionClick=function(e){switch(e.currentTarget.dataset.action){case"left":n.setState({isRedirect:!0,redirectAction:"left"});break;case"right":n.setState({isRedirect:!0,redirectAction:"right"})}},n.redirectClone=function(e){window.location.href=window.location.origin+e},n.state={isRedirect:!1,redirectAction:"left"},n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.props.shouldDefaultRedirect&&e.setState({isRedirect:!0})}),this.props.timmer)}},{key:"render",value:function(){var e=this.props,t=e.dialogTitle,i=e.subText,a=e.isActionBtnVisible,n=e.leftBtnText,o=e.shouldDefaultRedirect,r=e.rightBtnURI,c=e.rightBtnText,l=e.defaulltRedirectURI,m=e.isBlocking,u=e.leftBtnURI,p=this.state.redirectAction;return s.createElement("div",null,s.createElement(ye,{showModal:this.props.showModal,isBlocking:m},s.createElement("div",{className:"actionModal",dir:"ltr"},s.createElement("div",{className:"actionIcon"},this.getIcon()),s.createElement("div",{className:"actionHeading"},s.createElement("h2",null,t),s.createElement("p",null,s.createElement("span",null,i))),a&&s.createElement("div",{className:"actionButtonsDiv"},s.createElement(Ae.a,{key:"left",text:n,"data-action":"left",onClick:this.handlRedirectionClick}),s.createElement(Ae.a,{key:"right",text:c,"data-action":"right",onClick:this.handlRedirectionClick})),o&&this.state.isRedirect&&("Clone"===this.props.actionType?this.redirectClone(l):s.createElement(d.a,{to:l})),!o&&this.state.isRedirect&&s.createElement(d.a,{to:"left"==p?u:r}))))}}]),i}(s.Component)),De=i(267),xe=i(63),Ne=i(172),Ce=i(173),Ie={subText:{marginBottom:"0px!important"}},be=function(e){return c.a.createElement("div",null,c.a.createElement(De.a,{hidden:e.hideDialog,dialogContentProps:{type:xe.a.normal,title:e.title,subText:e.subText},modalProps:{isBlocking:e.isBlocking},onDismiss:e.dismissClick,styles:Ie},e.children,c.a.createElement(Ne.a,null,c.a.createElement(Ae.a,{text:e.actionBtnTxt,onClick:e.handleAction}),!e.isBlocking&&c.a.createElement(Ce.a,{onClick:e.dismissClick,text:e.dismisBtnTxt}))))},we=i(325),ke=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(){return Object(a.a)(this,i),t.apply(this,arguments)}return Object(n.a)(i,[{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,"Command"===this.props.buttonType?c.a.createElement(we.a,{iconProps:{iconName:this.props.iconString},disabled:this.props.disabled,text:this.props.buttonTxt,onClick:this.props.onBtnClick,name:this.props.buttonTxt}):"Primary"===this.props.buttonType?c.a.createElement(Ae.a,{disabled:this.props.disabled,text:this.props.buttonTxt,onClick:this.props.onBtnClick,name:this.props.buttonTxt}):c.a.createElement(Ce.a,{disabled:this.props.disabled,text:this.props.buttonTxt,onClick:this.props.onBtnClick,name:this.props.buttonTxt}),c.a.createElement(be,{hideDialog:this.props.hideDialog,title:this.props.dialogTitle,handleAction:this.props.handleAction,actionBtnTxt:this.props.actionBtnTxt,isBlocking:this.props.isBlocking,subText:this.props.subText,dismissClick:this.props.onBtnClick,dismisBtnTxt:this.props.dismisBtnTxt,CustClassName:this.props.CustClassName},this.props.children))}}]),i}(s.Component),Fe=i(94),Te=i(21),Le=i(65),Oe={wrappetr:{width:"100%",display:"block"},root:{width:"100%"},field:{height:200}},Me={activityDate:"",selectedShiftIds:"",activityName:"",activityDescription:"",bookedForEmail:"",visitorEmail:"",selectedLocations:""},Pe=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).updateStateLSA=function(e){var t=n.alertLSAFullyBooked(e);n.setState({LsaArr:e,showErrorMsg:t,errorMsg:N.a.ActivityForm.FullyBookedAlertMsg})},n.checkExpDateIsPast=function(e){var t=Te(e),i=Te(Fe.j).diff(t,"days");return e&&i>0?new Date(R()):e},n.arrangeFormFields=function(e,t){var i=n.context.name,a=n.context.userName,o=[];if(N.a.ActivityForm.showTBD){var r=D.filter(e,{DisplayName:N.a.ActivityForm.TBDRejectDispName});if(r&&r.length>0){var s=r[0];s.isSelected=!1,e=D.reject(e,{DisplayName:N.a.ActivityForm.TBDRejectDispName}),o.push(s);for(var c=0;c<e.length;c++){var l=e[c];l.isSelected=!1,o.push(l)}}}else(e=D.reject(e,{DisplayName:N.a.ActivityForm.TBDRejectDispName})).map((function(e){return e.isSelected=!1})),o=e;var d=U(t,n.props.office),m=n.state.newActivity,u=n.props.ExpData;m.selectedShiftIds=[],m.bookedByEmail.DisplayName=i,m.bookedByEmail.Email=a;m.bookedForEmail.push({}),m.bookedForEmail[0].DisplayName=i,m.bookedForEmail[0].UserLogin=a,m.bookedForEmail[0].Email=a,u&&(m.ExperimentId=u.ExpId,m.ExperimentOwner=u.ExpOwnerEmail,m.activityDate=n.checkExpDateIsPast(u.ExpStartDate),m.ExperimentStartDate=u.ExpStartDate),n.setState({ShiftTimmings:o,newActivity:m,Locations:d,Equipments:t,isLoaded:!0,selectedFor:[].concat(Object(f.a)(n.state.selectedFor),[m.bookedForEmail[0]]),locationEquipKey:Le()}),u&&n.props.handleActivityActions&&n.props.handleActivityActions("Form Loaded","LoadForm")},n.handleFormFieldChange=function(e,t){var i=n.state,a=i.newActivity,o=i.LsaArr;a[t]=e,n.alertLSAFullyBooked(o)&&"selectedShiftIds"===t?n.setState({newActivity:a,showErrorMsg:!0,errorMsg:N.a.ActivityForm.FullyBookedAlertMsg}):n.setState({newActivity:a,showErrorMsg:!1,errorMsg:""})},n.handleEquipmentSelection=function(e,t){var i=n.state.newActivity;i[t]=e,n.setState({newActivity:i})},n.handleLocationSelection=function(e,t){var i=n.state,a=i.newActivity,o=i.LsaArr;a.selectedLocations=e,a.selectedEquipments=t,n.alertLSAFullyBooked(o)?n.setState({newActivity:a,showErrorMsg:!0,errorMsg:N.a.ActivityForm.FullyBookedAlertMsg}):n.setState({newActivity:a,showErrorMsg:!1,errorMsg:""})},n.handleOnChange=function(e){var t=n.state.newActivity,i=e.target.value;"string"===typeof i&&(""===i.trim()?t[e.target.name]="":t[e.target.name]=i),"visitorEmail"===e.target.name?(t[e.target.name]=i,n.setState({newActivity:t})):"bookedForEmail"===e.target.name?(t[e.target.name]=i,n.setState({selectedFor:e.target.selectedFor,newActivity:t})):"showVisitorField"===e.target.name?(t[e.target.name]=i,t.visitorEmail="",n.setState({newActivity:t})):n.setState({newActivity:t})},n.validateFields=function(e){var t=["activityName","visitorEmail"],i=e,a=!0,o=["Activity Name is required field.","Visitor Email is required field."],r=n.props.ExpData;n.props.office&&(e.selectedEquipments=[],e.selectedLocations=[N.a.ActivityForm.officeSpaceUsageLocation]);try{for(var s=0;s<t.length;s++){var c=t[s];if("visitorEmail"===c){if(e.showVisitorField){var l=i[c];if(""===l)n.addValidationError(o[s],t[s],a),a=!1;else if(!H(l)){n.addValidationError("Visitor Email field should contain valid email.",t[s],a),a=!1}}}else""===i[c]&&(n.addValidationError(o[s],t[s],a),a=!1)}if(isNaN(e.activityDate.getTime()))n.addValidationError("Activity Date is required field.","activityDate",a),a=!1;else if(r){var d=Te(e.activityDate),m=Te(),u=Te(r.ExpStartDate);if(m.diff(d,"days")>0&&(n.addValidationError("Activity Date should be selected from future dates.","activityDate",a),a=!1),u.diff(d,"days")>0){var p="Select Activity Date from future dates and should not be before experiment date.";a&&(p="Activity Date should be selected from future dates."),n.addValidationError(p,"activityDate",a),a=!1}}e.selectedShiftIds.length<1&&(n.addValidationError("Activity Shift is required field.","selectedShiftIds",a),a=!1),!e.showVisitorField&&e.bookedForEmail.length<1&&(n.addValidationError("Person Name is required field.","bookedForEmail",a),a=!1),e.selectedLocations.length<1&&(n.addValidationError("Location is required field.","selectedLocations",a),a=!1)}catch(h){console.log(h),a=!1}return a},n.addValidationError=function(e,t,i){n.setState((function(a){var n={};return i||(n=Object(v.a)({},a.errorMsgs)),n[t]=e,{errorMsgs:n}}))},n.alertLSAFullyBooked=function(e){var t=n.state.newActivity,i=D.filter(e,{OnAlert:!0}),a=!1;i.length>0&&(D.filter(i,(function(e){var i=!1,a=!1;return-1!==t.selectedShiftIds.indexOf(e.ShiftId)&&(i=!0),-1!==t.selectedLocations.indexOf(e.LocationId)&&(a=!0),i&&a})).length>0&&(a=!0));return a},n.handleFormSaveClick=function(e){e.preventDefault();var t=n.state,i=t.newActivity,a=t.LSAFullyBooked,o=t.LsaArr;a?n.setState({LSAFullyBooked:!1}):n.validateFields(i)?(n.setState({showErrorMsg:!1,errorMsg:"",errorMsgs:Me}),n.alertLSAFullyBooked(o)?n.setState({LSAFullyBooked:!0}):n.callForCreate(i,N.a.ActivityForm.OfcAndIndiActivityType)):n.setState({showErrorMsg:!0,errorMsg:N.a.ActivityForm.ErrorValidationMessage})},n.handleFormSaveClickAction=function(){var e=n.state.newActivity;n.callForCreate(e,N.a.ActivityForm.OfcAndIndiActivityType)},n.callForCreate=function(e,t){var i,a;n.setState({SaveFlag:!0,LSAFullyBooked:!1}),(i=e,a=t,new Promise((function(e,t){T.createActivityRecord(i,a).then((function(t){return e(t)})).catch((function(e){t(e)}))}))).then((function(t){n.setState({SaveFlag:!1,isCreated:!0,actionType:"Create"}),n.props.ExpData&&n.props.handleActivityActions&&n.props.handleActivityActions(e,"CreatedActivity")})).catch((function(e){n.setState({SaveFlag:!1,showErrorMsg:!0,actionType:"Failed",errorMsg:N.a.ActivityForm.CreationErrorMessage+e}),console.log(e)}))},n.loadSpinner=function(e,t){return s.createElement("div",{className:"centeredContainer"},s.createElement(ve.a,{label:e,hideDialog:!t}))},n.clearShiftSelection=function(){for(var e=[],t=n.state.ShiftTimmings,i=0;i<t.length;i++){var a=t[i];a.isSelected=!1,e.push(a)}return e},n.handleCancelClick=function(){var e=n.state.hideCancelDialog;n.setState({hideCancelDialog:!e})},n.handleCancelAction=function(){n.setState({isRedirect:!0})},i.contextType=fe.b,n.state={newActivity:{activityDate:new Date(R()),ExperimentId:null,DayOffset:0,selectedShiftIds:[],activityName:"",activityDescription:"",bookedForEmail:[],bookedByEmail:{},visitorEmail:"",selectedLocations:[],selectedEquipments:[],showVisitorField:!1},errorMsgs:{activityDate:"",selectedShiftIds:"",activityName:"",activityDescription:"",bookedForEmail:"",visitorEmail:"",selectedLocations:""},ShiftTimmings:[],Locations:[],selectedFor:[],Equipments:[],locationEquipKey:Le(),isLoaded:!1,showErrorMsg:!1,SaveFlag:!1,isCreated:!1,hideCancelDialog:!0,isRedirect:!1,LSAFullyBooked:!1,errorMsg:"",actionType:"Create",formFieldKey:Le(),LsaArr:[]},n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this,t=[];t.push(j()),t.push(_()),Promise.all(t).then((function(t){if(t.length>0){var i=t[0]?t[0]:[],a=t[1]?t[1]:[];e.arrangeFormFields(i,a)}else e.setState({isLoaded:!0,showErrorMsg:!0,errorMsg:N.a.ActivityForm.ErrorDataFetchMessage})})).catch((function(t){e.setState({isLoaded:!0,showErrorMsg:!0,errorMsg:N.a.ActivityForm.ErrorDataFetchMessage}),console.log(t)}))}},{key:"componentDidUpdate",value:function(e,t){var i=this.props.ExpData,a=this.state.newActivity;if(i&&e.ExpData){i.ExpOwnerEmail!==e.ExpData.ExpOwnerEmail&&(a.ExperimentId=i.ExpId,a.ExperimentOwner=i.ExpOwnerEmail,a.ExperimentStartDate=i.ExpStartDate,a.activityDate=this.checkExpDateIsPast(i.ExpStartDate),this.setState({newActivity:a}));var n=Te(e.ExpData.ExpStartDate);0!==Te(i.ExpStartDate).diff(n,"days")&&(a.ExperimentId=i.ExpId,a.ExperimentOwner=i.ExpOwnerEmail,a.ExperimentStartDate=i.ExpStartDate,a.activityDate=this.checkExpDateIsPast(i.ExpStartDate),this.setState({newActivity:a,formFieldKey:Le()})),i.ExperimentNotSaved!==e.ExpData.ExperimentNotSaved&&(a.ExperimentId=i.ExpId,a.ExperimentOwner=i.ExpOwnerEmail,a.ExperimentStartDate=i.ExpStartDate,a.activityDate=this.checkExpDateIsPast(i.ExpStartDate),this.setState({newActivity:a,formFieldKey:Le()}))}}},{key:"renderErrorMsg",value:function(e){return s.createElement(g.a,{messageBarType:E.a.error,className:"errorMsgInfo"},e)}},{key:"render",value:function(){var e=this.state,t=e.isLoaded,i=e.ShiftTimmings,a=e.newActivity,n=e.errorMsgs,o=e.Equipments,r=e.Locations,c=e.selectedFor,l=e.locationEquipKey,m=e.showErrorMsg,u=e.errorMsg,p=e.formFieldKey,h=e.isCreated,v=e.actionType,f=e.SaveFlag,g=e.hideCancelDialog,E=e.isRedirect,D=e.LSAFullyBooked,x=this.props,I=x.office,b=x.NotPopActions,w=x.ExpData,k=I?"Office Usage":"Lab Activity",F=N.a.ActivityForm.FullyBookedDialogMsg;return s.createElement("div",{className:"formMain"},t?s.createElement(s.Fragment,null,s.createElement(C,{FormHeading:"Add "+k},s.createElement("div",{className:"ms-Grid",dir:"ltr"},s.createElement("div",{className:"ms-Grid-row"},s.createElement("div",{className:"ms-Grid-col ms-sm8"},s.createElement("div",null,s.createElement(Z,{key:p.toString(),activityDate:a.activityDate,selectedShiftIds:a.selectedShiftIds,shiftTimmings:i,errorMsgs:n,ExpId:a.ExperimentId,ExpDate:a.ExperimentStartDate,handleFormFieldChange:this.handleFormFieldChange})),s.createElement(pe,{key:p.toString(),errorMsgs:n,activityName:a.activityName,selectedFor:c,showVisitorField:a.showVisitorField,visitorEmail:a.visitorEmail,handleOnChange:this.handleOnChange}),s.createElement("div",{className:"ms-Grid-row"},s.createElement("div",{className:"ms-Grid-col ms-sm5"},s.createElement(y.a,{multiline:!0,label:"Activity Description",name:"activityDescription",placeholder:"Activity Description",value:a.activityDescription,errorMessage:n.activityDescription,onChange:this.handleOnChange,styles:Oe})),s.createElement("div",{className:"ms-Grid-col ms-sm7"},I?"":s.createElement(he,{key:l,locationEquipKey:l,Equipments:o,Locations:r,errorMsgs:n,selectedLocations:a.selectedLocations,selectedEquipments:a.selectedEquipments,handleLocationSelectionChange:this.handleLocationSelection,handleEquipmentSelectionChange:this.handleEquipmentSelection}))),s.createElement("div",{className:"ms-Grid-row"},s.createElement("div",{className:"ms-Grid-col ms-sm8"}))),s.createElement("div",{className:"ms-Grid-col ms-sm4"},s.createElement("div",{className:"ms-Grid-row shiftLocation"},s.createElement(K,{sendLsaArr:this.updateStateLSA,Shifts:i,office:I,Locations:r,activityDate:R(a.activityDate)})))),m?this.renderErrorMsg(u):"",s.createElement("div",{className:(null===w||void 0===w?void 0:w.ExperimentNotSaved)?"displayNone":"row formHeadflex",key:"divButtons"},s.createElement("div",{className:"button-right"},s.createElement("div",{className:"leftBtns"},s.createElement(ke,{key:"Save",CustClassName:"BlockingDialog",iconString:"Cancel",hideDialog:!D,buttonTxt:"Add",onBtnClick:this.handleFormSaveClick,buttonType:"Primary",dialogTitle:"Location Fully Booked",subText:F+" Create "+k+"?",isBlocking:!1,handleAction:this.handleFormSaveClickAction,actionBtnTxt:"Yes",dismisBtnTxt:"No"}),s.createElement(ke,{key:"Cancel",CustClassName:"BlockingDialog",iconString:"Cancel",hideDialog:g,buttonTxt:"Cancel",onBtnClick:this.handleCancelClick,buttonType:"Default",dialogTitle:"Cancel?",subText:"Changes made to "+k+" will not be saved.",isBlocking:!1,handleAction:this.handleCancelAction,actionBtnTxt:"Yes",dismisBtnTxt:"No"}))))))):s.createElement("div",{className:"centeredContainer"},s.createElement(A.a,{size:S.a.large})),f?this.loadSpinner("Creating "+k+"...",f):"",E?s.createElement(d.a,{to:"/Home"}):"",h&&!b?s.createElement(Se,{subText:k+" Created. Redirecting to Home page...",dialogTitle:"Created Successfully",actionBtnTxt:"go Home",showModal:h,isBlocking:!0,actionType:v,shouldDefaultRedirect:!0,defaulltRedirectURI:"/Home",timmer:N.a.ActivityForm.FormRedirectionTimmer}):"")}}]),i}(s.Component),Re=i(72),Be=i.n(Re),Ue=i(70),je=i(21),_e=i(65),qe={wrappetr:{width:"100%",display:"block"},root:{width:"100%"},field:{height:200}},He={activityDate:"",selectedShiftIds:"",activityName:"",activityDescription:"",bookedForEmail:"",visitorEmail:"",selectedLocations:"",activityNotes:""},Ge={ExperimentId:null,DayOffset:0,activityDate:new Date(R()),selectedShiftIds:[],activityName:"",activityDescription:"",bookedForEmail:[],bookedByEmail:{},visitorEmail:"",selectedLocations:[],selectedEquipments:[],showVisitorField:!1},Ve=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).initialEditActivity={},n.updateStateLSA=function(e){var t=n.alertLSAFullyBooked(e);n.setState({LsaArr:e,showErrorMsg:t,errorMsg:N.a.ActivityForm.FullyBookedAlertMsg})},n.checkIfUSerAdmiOrEditor=function(e){var t=!1;console.log(n.context);try{var i;if(n.context.isAdmin)t=!0;else if(e.bookedByEmail.Email.toUpperCase()===n.context.userName.toUpperCase()&&(t=!0),e.showVisitorField||e.bookedForEmail[0].Email.toUpperCase()!==n.context.userName.toUpperCase()||(t=!0),e.ExperimentId)(null===(i=e.ExperimentOwner)||void 0===i?void 0:i.toUpperCase())===n.context.userName.toUpperCase()&&(t=!0)}catch(a){console.log("checkIfUSerAdmiOrEditor",a)}return console.log("Can Edit",t),t},n.checkIfRecordIsEditable=function(e){var t=!0,i=je(e.activityDate),a=je(Fe.j).diff(i,"days"),o=N.a.ActivityForm.officeSpaceUsageLocation;try{e.ActivityStatus===N.a.ActivityForm.InactiveStatusId&&(t=!1),e.activityDate&&a>0&&(t=!1),n.props.office?(e.selectedEquipments.length>0&&(t=!1),e.selectedLocations.length>1&&(t=!1),e.selectedLocations[0]!==o&&(t=!1)):-1!==e.selectedLocations.indexOf(o)&&(t=!1),e.ExperimentId&&e.ExperimentStatusId===N.a.ActivityForm.InactiveStatusId&&(t=!1)}catch(r){console.log("checkIfRecordIsEditable",r)}return console.log("isEditable",t),t},n.arrangeFormFields=function(e,t,i){var a=[];if(N.a.ActivityForm.showTBD){var o=D.filter(e,{DisplayName:N.a.ActivityForm.TBDRejectDispName});if(o&&o.length>0){var r=o[0];r.isSelected=!0,e=D.reject(e,{DisplayName:N.a.ActivityForm.TBDRejectDispName}),a.push(r);for(var s=0;s<e.length;s++){var c=e[s];c.isSelected=!1,a.push(c)}[N.a.ActivityForm.TBDRejectShiftId]}}else(e=D.reject(e,{DisplayName:N.a.ActivityForm.TBDRejectDispName})).map((function(e){return e.isSelected=!1})),a=e;var l=U(t,n.props.office),d=n.getActivityDetailData(i);n.initialEditActivity=JSON.parse(JSON.stringify(d));var m=n.getShiftsSelection(a,d.selectedShiftIds),u=!1,p=n.checkIfUSerAdmiOrEditor(d);p?u=n.checkIfRecordIsEditable(d):u=p;var h=d.showVisitorField?[]:d.bookedForEmail,v=n.props,f=v.viewForm,g=v.ExpData;if(g){d.ExperimentId=g.ExpId,d.ExperimentOwner=g.ExpOwnerEmail;var E=B(g.ExpStartDate);d.ExperimentStartDate=E?new Date(E):null}n.setState({editActivityId:n.props.Id,InitialShifts:e,LocationEquipmentData:t,ShiftTimmings:m,editActivity:d,Locations:l,Equipments:t,canEdit:u,viewForm:f||!u,selectedFor:h,isLoaded:!0,locationEquipKey:_e()}),g&&n.props.handleActivityActions&&n.props.handleActivityActions("Form Loaded","LoadForm")},n.handleFormFieldChange=function(e,t){var i=n.state.editActivity,a=n.state.LsaArr;i[t]=e,n.alertLSAFullyBooked(a)&&"selectedShiftIds"===t?n.setState({editActivity:i,showErrorMsg:!0,errorMsg:N.a.ActivityForm.FullyBookedAlertMsg}):n.setState({editActivity:i,showErrorMsg:!1,errorMsg:""})},n.handleEquipmentSelection=function(e,t){var i=n.state.editActivity;i[t]=e,n.setState({editActivity:i})},n.handleLocationSelection=function(e,t){var i=n.state,a=i.editActivity,o=i.LsaArr;a.selectedLocations=e,a.selectedEquipments=t,n.setState({editActivity:a}),n.alertLSAFullyBooked(o)?n.setState({editActivity:a,showErrorMsg:!0,errorMsg:N.a.ActivityForm.FullyBookedAlertMsg}):n.setState({editActivity:a,showErrorMsg:!1,errorMsg:""})},n.handleOnChange=function(e){var t=n.state.editActivity,i=e.target.value;"string"===typeof i&&(""===i.trim()?t[e.target.name]="":t[e.target.name]=i),"visitorEmail"===e.target.name?(t[e.target.name]=i,t.bookedForEmail=[],n.setState({editActivity:t})):"bookedForEmail"===e.target.name?(t[e.target.name]=i,n.setState({selectedFor:e.target.selectedFor,editActivity:t})):"showVisitorField"===e.target.name?(t[e.target.name]=i,t.bookedForEmail=[],t.visitorEmail="",n.setState({editActivity:t})):n.setState({editActivity:t})},n.loadSpinner=function(e,t){return s.createElement("div",{className:"centeredContainer"},s.createElement(ve.a,{label:e,hideDialog:!t}))},n.clearShiftSelection=function(){for(var e=[],t=n.state.ShiftTimmings,i=0;i<t.length;i++){var a=t[i];a.isSelected=!1,e.push(a)}return e},n.validateFields=function(e){var t=["activityName","visitorEmail"],i=e,a=!0,o=["Activity Name is required field.","Visitor Email is required field."],r=n.props.ExpData;try{for(var s=0;s<t.length;s++){var c=t[s];if("visitorEmail"===c){if(e.showVisitorField){var l=i[c];if(""===l)n.addValidationError(o[s],t[s],a),a=!1;else if(!H(l)){n.addValidationError("Visitor Email field should contain valid email.",t[s],a),a=!1}}}else""===i[c]&&(n.addValidationError(o[s],t[s],a),a=!1)}if(isNaN(new Date(e.activityDate).getTime()))n.addValidationError("Activity Date is required field.","activityDate",a),a=!1;else{var d=je(Fe.j),m=je(e.activityDate);d.diff(m,"days")>0&&(n.addValidationError("Activity Date should be selected from future dates.","activityDate",a),a=!1)}if(r){m=je(e.activityDate),d=je();if(je(r.ExpStartDate).diff(m,"days")>0){var u="Select Activity Date from future dates and should not be before experiment date.";a||(u="Activity Date should be selected from future dates."),n.addValidationError(u,"activityDate",a),a=!1}}else{if(e.ExperimentId&&e.ExperimentStartDate)if(je(e.ExperimentStartDate).diff(m,"days")>0){var p="Select Activity Date from future dates and should not be before experiment date.";a||(p="Activity Date should be selected from future dates."),n.addValidationError(p,"activityDate",a),a=!1}}e.selectedShiftIds.length<1&&(n.addValidationError("Activity Shift is required field.","selectedShiftIds",a),a=!1),!e.showVisitorField&&e.bookedForEmail.length<1&&(n.addValidationError("Person Name is required field.","bookedForEmail",a),a=!1),e.selectedLocations.length<1&&(n.addValidationError("Location is required field.","selectedLocations",a),a=!1)}catch(h){console.log(h),a=!1}return a},n.addValidationError=function(e,t,i){n.setState((function(a){var n={};return i||(n=Object(v.a)({},a.errorMsgs)),n[t]=e,{errorMsgs:n}}))},n.updateExperimentForm=function(e,t){n.props.ExpData&&n.props.handleActivityActions&&n.props.handleActivityActions(e,t)},n.handleCloneClick=function(e){e.preventDefault();var t=n.state.hideCloneDialog;n.setState({hideCloneDialog:!t})},n.handleAddClick=function(e){e.preventDefault();var t=n.state.editActivity;n.setState({showErrorMsg:!1,errorMsg:"",errorMsgs:He}),n.callForCreate(t,N.a.ActivityForm.OfcAndIndiActivityType)},n.callForCreate=function(e,t){n.setState({SaveFlag:!0,isClone:!0,hideCloneDialog:!0});e.ExperimentId&&e.ExperimentId;var i,a={ActivityId:e.Id};(i=a,new Promise((function(e,t){T.CloneIndividualActivity(i).then((function(t){return e(t)})).catch((function(e){t(e)}))}))).then((function(e){var t=null===e||void 0===e?void 0:e.id;n.setState({SaveFlag:!1,isCreated:!0,viewForm:!1,editActivityId:t,actionType:"Clone"})})).catch((function(e){n.setState({SaveFlag:!1,actionType:"Failed",showErrorMsg:!0,errorMsg:N.a.ActivityForm.CloneErrorMessage+e}),console.log(e)}))},n.callForUpdate=function(e,t,i){n.setState({SaveFlag:!0});var a=n.state.editActivityId;e.Id=a,n.props.office&&(e.selectedEquipments=[],e.selectedLocations=[N.a.ActivityForm.officeSpaceUsageLocation]);var o,r,s,c=i+" - Modified by "+n.context.userName;(o=e,r=t,s=c,new Promise((function(e,t){T.updateActivityRecord(o,r,s).then((function(t){return e(t)})).catch((function(e){t(e)}))}))).then((function(t){n.props.ExpData&&n.updateExperimentForm(e,"UpdatedActivity"),n.setState({SaveFlag:!1,hideUpdateDialog:!0,isUpdated:!0,actionType:"Update"})})).catch((function(e){n.setState({SaveFlag:!1,hideUpdateDialog:!0,actionType:"Failed",isUpdated:!1,showErrorMsg:!0,errorMsg:N.a.ActivityForm.UpdateErrorMessage+e}),console.log(e)}))},n.alertLSAFullyBooked=function(e){var t=n.state.editActivity,i=D.filter(e,{OnAlert:!0}),a=!1;i.length>0&&(D.filter(i,(function(e){var i=!1,a=!1;return-1!==t.selectedShiftIds.indexOf(e.ShiftId)&&(i=!0),-1!==t.selectedLocations.indexOf(e.LocationId)&&(a=!0),i&&a})).length>0&&(a=!0));return a},n.handleFormSaveClick=function(e){e.preventDefault();var t=n.state,i=t.editActivity,a=t.hideUpdateDialog,o=t.errorMsgs,r=t.LsaArr;if(n.validateFields(i)){var s=n.alertLSAFullyBooked(r);o.activityNotes="",n.setState({hideUpdateDialog:!a,activityNotes:"",LSAFullyBooked:s,showErrorMsg:!1,errorMsg:"",errorMsgs:He})}else n.setState({showErrorMsg:!0,errorMsg:N.a.ActivityForm.ErrorValidationMessage})},n.handleUpdateAction=function(){var e=n.state,t=e.activityNotes,i=e.editActivity,a=(e.isClone,e.errorMsgs);n.setState({hideUpdateDialog:!1}),a.activityNotes="",n.setState({SaveFlag:!0,errorMsgs:a}),n.callForUpdate(i,N.a.ActivityForm.OfcAndIndiActivityType,t)},n.handleNotesChange=function(e){var t=e.target.value,i="";i=""===t.trim()?"":t,n.setState({activityNotes:i})},n.handleDelete=function(){var e=n.state,t=e.hideDeleteDialog,i=e.errorMsgs;i.activityNotes="",n.setState({hideDeleteDialog:!t,errorMsgs:i,activityNotes:""})},n.handleDeleteAction=function(){var e=n.state.errorMsgs;e.activityNotes="",n.setState({hideDeleteDialog:!1,SaveFlag:!0,errorMsgs:e});var t,i,a="Deleted by "+n.context.userName;(t=n.state.editActivityId,i=a,new Promise((function(e,a){T.deleteActivityRecordById(t,i).then((function(t){return e(t)})).catch((function(e){a(e)}))}))).then((function(e){n.props.ExpData&&n.updateExperimentForm("Close","DeleteActivity"),n.setState({SaveFlag:!1,hideDeleteDialog:!0,isDeleted:!0,actionType:"Delete"})})).catch((function(e){n.setState({SaveFlag:!1,isDeleted:!1,actionType:"Failed",hideDeleteDialog:!0,showErrorMsg:!0,errorMsg:N.a.ActivityForm.DeleteErrorMessage+e}),console.log(e)}))},n.handleCancelClick=function(){var e=n.state.hideCancelDialog;n.setState({hideCancelDialog:!e})},n.handleCancelAction=function(e){e.preventDefault(),n.props.ExpData?n.updateExperimentForm("Close","CloseForm"):n.setState({isRedirect:!0})},n.handleEditClick=function(){n.setState({viewForm:!1}),n.props.ExpData&&n.updateExperimentForm("Changed view to update","ViewToEdit")},i.contextType=fe.b,n.state={editActivity:{ExperimentId:null,DayOffset:0,activityDate:new Date(R()),selectedShiftIds:[],activityName:"",activityDescription:"",bookedForEmail:[],bookedByEmail:{},visitorEmail:"",selectedLocations:[],selectedEquipments:[],showVisitorField:!1},InitialShifts:[],LocationEquipmentData:[],errorMsgs:{activityDate:"",selectedShiftIds:"",activityName:"",activityDescription:"",bookedForEmail:"",visitorEmail:"",selectedLocations:"",activityNotes:""},editActivityId:0,canEdit:!0,ShiftTimmings:[],activityNotes:"",hideDeleteDialog:!0,hideUpdateDialog:!0,hideCancelDialog:!0,hideCloneDialog:!0,Locations:[],selectedFor:[],Equipments:[],locationEquipKey:_e(),isLoaded:!1,showErrorMsg:!1,SaveFlag:!1,isUpdated:!1,isRedirect:!1,isCreated:!1,isDeleted:!1,errorMsg:"",formFieldKey:_e(),isClone:!1,actionType:"Update",LSAFullyBooked:!1,LsaArr:[]},n.handleCancelAction=n.handleCancelAction.bind(Object(Ue.a)(n)),n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this,t=[];t.push(j()),t.push(_()),t.push(q(this.props.Id)),Promise.all(t).then((function(t){if(t.length>0){var i=t[0]?t[0]:[],a=t[1]?t[1]:[],n=t[2]?t[2]:[];e.arrangeFormFields(i,a,n)}else e.setState({editActivityId:e.props.Id,isLoaded:!0,showErrorMsg:!0,errorMsg:N.a.ActivityForm.ErrorDataFetchMessage})})).catch((function(t){e.setState({editActivityId:e.props.Id,isLoaded:!0,showErrorMsg:!0,errorMsg:N.a.ActivityForm.ErrorDataFetchMessage}),console.log(t)}))}},{key:"componentDidUpdate",value:function(e,t){var i=this,a=this.props,n=a.Id,o=a.ExpData,r=this.state.editActivity;if(e.Id!==n&&q(this.props.Id).then((function(e){if(e>0){var t=e||[],a=i.state,n=a.LocationEquipmentData,o=a.InitialShifts;i.arrangeFormFields(o,n,t)}else i.setState({editActivityId:i.props.Id,isLoaded:!0,showErrorMsg:!0,errorMsg:N.a.ActivityForm.ErrorDataFetchMessage})})),o&&e.ExpData){o.ExpOwnerEmail===e.ExpData.ExpOwnerEmail||o.ExperimentNotSaved||(r.ExperimentOwner=o.ExpOwnerEmail,this.setState({editActivity:r}));var s=je(r.ExperimentStartDate);0===je(o.ExpStartDate).diff(s,"days",!0)||o.ExperimentNotSaved||(r.ExperimentOwner=o.ExpOwnerEmail,r.ExperimentStartDate=o.ExpStartDate,this.setState({editActivity:r,formFieldKey:_e()})),o.ExperimentNotSaved!==e.ExpData.ExperimentNotSaved&&this.setState({formFieldKey:_e()})}}},{key:"getShiftsSelection",value:function(e,t){for(var i=0;i<e.length;i++){var a=e[i];-1!==t.indexOf(a.Id)?a.isSelected=!0:a.isSelected=!1}return e}},{key:"getActivityDetailData",value:function(e){var t=Object(v.a)({},Ge);try{var i=e.ActivytData[0];t.Id=i.ActivityId;var a=B(i.ActivityDate);if(t.activityDate=a?new Date(a):null,t.activityName=i.ActivityName,t.activityDescription=i.ActivityDescription,t.showVisitorField=!i.IsEmployee,i.IsEmployee){var n={};n.DisplayName=i.BookedForName,n.Email=i.BookedForEmail,t.bookedForEmail=[],t.bookedForEmail.push(n)}else t.showVisitorField=!0,t.visitorEmail=i.BookedForEmail;var o={};o.DisplayName=i.BookedByName,o.Email=i.BookedByEmail,t.bookedByEmail=o,t.DayOffset=i.DayOffset,t.selectedShiftIds=e.ActivityShift,t.selectedLocations=e.ActivityLocation,t.selectedEquipments=e.ActivityEquipment,t.ExperimentId=i.ExperimentId,t.ExperimentOwner=i.ExperimentOwner,t.ExperimentStatusId=i.ExperimentStatusId;var r=B(i.ExperimentStartDate);t.ExperimentStartDate=r?new Date(r):null,t.ActivityStatus=i.ActivityStatus}catch(s){console.log(s)}return t}},{key:"renderErrorMsg",value:function(e,t){return s.createElement(g.a,{messageBarType:E.a.error,className:"errorMsgInfo"},e)}},{key:"handleActionAndRediret",value:function(){var e=this.state,t=e.isCreated,i=e.isUpdated,a=e.isDeleted,n=e.editActivityId,o=e.actionType,r=e.canEdit,c=e.isClone,l=e.viewForm,d=this.props,m=d.office,u=d.NotPopActions,p=m?"Office Usage":"Lab Activity",h=m?"/PlanOfficeSpace?id="+n:"/PlanActivity?id="+n;return s.createElement("div",null,i&&!u?s.createElement(Se,{subText:p+" updated. Redirecting to Home page...",dialogTitle:"Updated Successfully",actionBtnTxt:"go Home",showModal:i,isBlocking:!0,actionType:o,shouldDefaultRedirect:!0,defaulltRedirectURI:"/Home",timmer:N.a.ActivityForm.FormRedirectionTimmer}):"",a&&!u?s.createElement(Se,{subText:p+" Deleted. Redirecting to Home page...",dialogTitle:"Deleted Successfully",actionBtnTxt:"go Home",showModal:a,isBlocking:!0,actionType:o,shouldDefaultRedirect:!0,defaulltRedirectURI:"/Home",timmer:N.a.ActivityForm.FormRedirectionTimmer}):"",t&&!u?s.createElement(Se,{subText:p+" Cloned. Redirecting to newly created "+p+"...",dialogTitle:"Created Successfully",isBlocking:!0,actionBtnTxt:"go Home",showModal:t,actionType:o,shouldDefaultRedirect:!0,defaulltRedirectURI:h,timmer:N.a.ActivityForm.FormRedirectionTimmer}):"",r||u||l||c?"":s.createElement(Se,{subText:"Do not have permission to edit the "+p,dialogTitle:"Access Denied",isBlocking:!1,actionBtnTxt:"go Home",showModal:!0,isActionBtnVisible:!0,shouldDefaultRedirect:!1,leftBtnText:"Go Home",leftBtnURI:"/Home",rightBtnText:"My Activities",rightBtnURI:"/MyActivities",actionType:"Denied"}))}},{key:"render",value:function(){var e=this.state,t=e.isLoaded,i=e.ShiftTimmings,a=e.editActivity,n=e.errorMsgs,o=e.Equipments,r=e.Locations,c=e.selectedFor,l=e.locationEquipKey,m=e.showErrorMsg,u=e.errorMsg,p=e.formFieldKey,h=e.SaveFlag,v=e.activityNotes,f=e.hideDeleteDialog,g=e.hideUpdateDialog,E=e.canEdit,D=e.isClone,x=e.hideCancelDialog,I=e.hideCloneDialog,b=e.isRedirect,w=e.viewForm,k=e.LSAFullyBooked,F=this.props,T=F.office,L=F.ExpData,O=F.NotPopActions,M=w?"View ":"Edit ",P=T?"Office Usage":"Lab Activity",B=N.a.ActivityForm.FullyBookedDialogMsg,U="Are you sure you want to update the "+P+"? Please add notes for the update.";return U=k?B+U:U,s.createElement("div",{className:"formMain"},t?s.createElement(s.Fragment,null,s.createElement(C,{FormHeading:M+P},s.createElement("div",{className:"ms-Grid",dir:"ltr"},s.createElement("div",{className:"ms-Grid-row"},s.createElement("div",{className:"ms-Grid-col ms-sm9"},s.createElement("div",null,s.createElement(Z,{key:p.toString(),activityDate:a.activityDate,selectedShiftIds:a.selectedShiftIds,viewForm:w,shiftTimmings:i,ExpId:a.ExperimentId,ExpDate:a.ExperimentStartDate,errorMsgs:n,handleFormFieldChange:this.handleFormFieldChange})),s.createElement(pe,{key:p.toString(),viewForm:w,errorMsgs:n,activityName:a.activityName,selectedFor:c,showVisitorField:a.showVisitorField,visitorEmail:a.visitorEmail,handleOnChange:this.handleOnChange}),s.createElement("div",{className:"ms-Grid-row"},s.createElement("div",{className:"ms-Grid-col ms-sm5"},s.createElement(y.a,{multiline:!0,disabled:w,label:"Activity Description",name:"activityDescription",placeholder:"Activity Description",value:a.activityDescription,errorMessage:n.activityDescription,onChange:this.handleOnChange,styles:qe})),s.createElement("div",{className:"ms-Grid-col ms-sm7"},T?"":s.createElement(he,{key:l,viewForm:w,locationEquipKey:l,Equipments:o,Locations:r,errorMsgs:n,selectedLocations:a.selectedLocations,selectedEquipments:a.selectedEquipments,handleLocationSelectionChange:this.handleLocationSelection,handleEquipmentSelectionChange:this.handleEquipmentSelection}))),s.createElement("div",{className:"ms-Grid-row"},s.createElement("div",{className:"ms-Grid-col ms-sm8"}))),s.createElement("div",{className:"ms-Grid-col ms-sm3"},s.createElement("div",{className:"ms-Grid-row shiftLocation"},s.createElement(K,{sendLsaArr:this.updateStateLSA,office:T,Shifts:i,Locations:r,activityDate:R(a.activityDate)})))),m?this.renderErrorMsg(u,"errorMsg"):"",E?"":this.renderErrorMsg("Access Denied: This record cannot be modified.","canEdit"),s.createElement("div",{className:(null===L||void 0===L?void 0:L.ExperimentNotSaved)?"displayNone":"row formHeadflex",key:"divButtons"},w&&s.createElement("div",{className:"button-right"},s.createElement("div",{className:"leftBtns"},E&&s.createElement(Ae.a,{key:"Edit",text:"Edit","data-action":"Edit",onClick:this.handleEditClick}),!O&&s.createElement(ke,{key:"Clone12",CustClassName:"BlockingDialog",iconString:"Clone",hideDialog:I,buttonTxt:"Clone",onBtnClick:this.handleCloneClick,buttonType:"Primary",dialogTitle:"Clone?",subText:"This will create a copy of this "+P+" and display it so you can update the date and other details. Do you want to proceed?",isBlocking:!1,handleAction:this.handleAddClick,actionBtnTxt:"Yes",dismisBtnTxt:"No"}),s.createElement(Ce.a,{key:"Close",onClick:this.handleCancelAction,text:"Close"}))),s.createElement("div",{className:w||D?"displayNone":"button-right"},s.createElement("div",{className:"leftBtns"},s.createElement(ke,{key:"update",CustClassName:"BlockingDialog",hideDialog:g,buttonTxt:"Update",onBtnClick:this.handleFormSaveClick,buttonType:"Primary",dialogTitle:"Update?",subText:U,isBlocking:!0,handleAction:this.handleUpdateAction,actionBtnTxt:"Update",dismisBtnTxt:"Cancel",disabled:w},s.createElement("div",null,s.createElement(y.a,{multiline:!0,label:"Notes (Optional)",name:"activityNotes",placeholder:"Change Reason",value:v,errorMessage:n.activityNotes,onChange:this.handleNotesChange}))),!O&&s.createElement(ke,{key:"CloneUpdate",CustClassName:"BlockingDialog",iconString:"Clone",hideDialog:I,buttonTxt:"Clone",onBtnClick:this.handleCloneClick,buttonType:"Primary",dialogTitle:"Clone?",subText:"This will create a copy of this "+P+" and display it so you can update the date and other details. Do you want to proceed?",isBlocking:!1,handleAction:this.handleAddClick,actionBtnTxt:"Yes",dismisBtnTxt:"No"}),s.createElement(ke,{key:"Cancel12",CustClassName:"BlockingDialog",iconString:"Cancel",hideDialog:x,buttonTxt:"Cancel",onBtnClick:this.handleCancelClick,buttonType:"Default",dialogTitle:"Cancel?",subText:"Changes made to "+P+" will not be saved.",isBlocking:!1,handleAction:this.handleCancelAction,actionBtnTxt:"Yes",dismisBtnTxt:"No"})),s.createElement("div",null,s.createElement(ke,{key:"Delete",CustClassName:"BlockingDialog",iconString:"Delete",hideDialog:f,buttonTxt:"Delete",onBtnClick:this.handleDelete,buttonType:"Primary",dialogTitle:"Delete?",subText:"Are you sure you want to delete the activity?",isBlocking:!1,handleAction:this.handleDeleteAction,actionBtnTxt:"Delete",disabled:w,dismisBtnTxt:"Cancel"}))))))):s.createElement("div",{className:"centeredContainer"},s.createElement(A.a,{size:S.a.large})),h&&f?this.loadSpinner(D?"Cloning "+P+"...":"Updating "+P+"...",h):"",h&&!f?this.loadSpinner("Deleting "+P+"...",h):"",b?s.createElement(d.a,{to:"/Home"}):"",this.handleActionAndRediret())}}]),i}(s.Component),Ke=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).state={isViewForm:!1,isNewForm:!0,itemId:"0"},n.props.handleRedirection("2"),n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=this.props.location?this.props.location.search:"",t=Be.a.parse(e);if(t){var i="0",a=!1;for(var n in t)if(n.toUpperCase()===N.a.ActivityForm.IdParam.toUpperCase()&&(i=t[n]),n.toUpperCase()===N.a.ActivityForm.ViewParam.toUpperCase()){var o=t[n];a=1==parseInt(o)}"0"!==i&&this.setState({isNewForm:!1,isViewForm:a,itemId:i})}}},{key:"render",value:function(){var e=this.state,t=e.isNewForm,i=e.itemId,a=e.isViewForm;return s.createElement("div",{style:{width:"90%",margin:"0.5em auto"}},t?s.createElement(Pe,null):s.createElement(s.Fragment,null,s.createElement(Ve,{Id:parseInt(i),viewForm:a})))}}]),i}(s.Component),We=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).state={isViewForm:!1,isNewForm:!0,itemId:"0"},n.props.handleRedirection("3"),n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){var e=Be.a.parse(this.props.location.search);if(e){var t="0",i=!1;for(var a in e)if(a.toUpperCase()===N.a.ActivityForm.IdParam.toUpperCase()&&(t=e[a]),a.toUpperCase()===N.a.ActivityForm.ViewParam.toUpperCase()){var n=e[a];i=1==parseInt(n)}"0"!==t&&this.setState({isNewForm:!1,isViewForm:i,itemId:t})}}},{key:"render",value:function(){var e=this.state,t=e.isNewForm,i=e.isViewForm,a=e.itemId;return s.createElement("div",{style:{width:"90%",margin:"0.5em auto"}},t?s.createElement(Pe,{office:!0}):s.createElement(s.Fragment,null,s.createElement(Ve,{Id:parseInt(a),office:!0,viewForm:i})))}}]),i}(s.Component),Ye={getActivitiesForUser:function(e,t,i){return new Promise((function(a,n){w.post("/api/ActivityGrid/GetActivityGridForUser",{UserEmail:e,StatusId:t,ExperimentId:i}).then((function(e){a(e)})).catch((function(e){console.log(e),n(e)}))}))},GetExpWithoutActivitiesGridForUser:function(e,t,i){return new Promise((function(a,n){w.post("/api/ActivityGrid/GetExperimentGridForUser",{UserEmail:e,StatusId:t,ExperimentId:i}).then((function(e){a(e)})).catch((function(e){console.log(e),n(e)}))}))}},ze=i(174),Je=i(304),Ze=i(308),Qe=i(17),$e=i(23),Xe=i(319),et=i(30),tt=i(21),it=i.n(tt),at=i(7),nt=i(21),ot={headerWrapper:{selectors:{"& .ms-DetailsHeader-cell:hover":{backgroundColor:"white!important"}}}},rt=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e))._getDataFromDB=function(){var e=n.context.userName;Ye.GetExpWithoutActivitiesGridForUser(e,1,null).then((function(e){var t=e.data,i=x.a.orderBy(t,"ExperimentStartDate");console.log(i),n.setState({ExperimentsWithoutActivites:i,isLoading:!1,errorMessage:""})})).catch((function(e){n.setState({isLoading:!1,errorMessage:"Error Occured!\n"+e,showErrorMessage:!0})}))},n._onRenderRow=function(e){var t={};return e?(e.itemIndex%2===0&&(t.root={backgroundColor:"#ebe9e8"}),s.createElement(ze.a,Object.assign({},e,{styles:t}))):null},n.checkIsPastRecord=function(e){var t=!0,i=nt(e.ExperimentStartDate);return nt(new Date).diff(i,"days")>0&&(t=!1),t},n._getColumns=function(){return[{key:"Edit",name:"Edit",fieldName:"ActivityId",minWidth:50,maxWidth:50,onRender:function(e){var t;return s.createElement("div",null,n.checkIsPastRecord(e)&&((null===(t=e.ExperimentOwner)||void 0===t?void 0:t.toUpperCase())===n.context.userName.toUpperCase()||n.context.isAdmin)?s.createElement(et.a,{to:"/PlanExperiment?id="+e.ExperimentId.toString()},s.createElement(u.a,{iconName:"EditSolid12",title:"Edit Activity",style:{color:"#4f4e4d"}})):s.createElement(et.a,{to:"/PlanExperiment?id="+e.ExperimentId.toString()+"&view=1"},s.createElement(u.a,{iconName:"LockSolid",title:"View-Only Activity",style:{color:"#4f4e4d"}})))}},{key:"ExperimentName",name:"Experiment Name",fieldName:"ExperimentName",minWidth:350,maxWidth:400},{key:"ExperimentStartDate",name:"Start Date",fieldName:"ExperimentStartDate",minWidth:60,maxWidth:70,onRender:function(e){return s.createElement("span",null,nt.utc(e.ExperimentStartDate).format("MM/DD/YYYY"))}},{key:"ExperimentOwnerName",name:"Experiment Owner",fieldName:"ExperimentOwnerName",minWidth:120,maxWidth:140},{key:"ExperimentDescription",name:"Description",fieldName:"ExperimentDescription",minWidth:100,maxWidth:120}]},n.state={ExperimentsWithoutActivites:[],isLoading:!1,errorMessage:"",gridLabel:"My Experiments (with no activities)",showErrorMessage:!1},i.contextType=fe.b,n}return Object(n.a)(i,[{key:"componentDidMount",value:function(){this.setState({isLoading:!0}),this._getDataFromDB()}},{key:"renderErrorMsg",value:function(e){return s.createElement(g.a,{messageBarType:E.a.error,className:"errorMsgInfo"},e)}},{key:"render",value:function(){var e=this.state,t=e.gridLabel,i=e.isLoading,a=e.errorMessage,n=e.showErrorMessage,o=e.ExperimentsWithoutActivites;return s.createElement("div",{className:"ExperimentGrid"},s.createElement("div",{style:{width:"90%",overflow:"auto",margin:"0 auto",paddingBottom:"10px",paddingTop:"30px"}},s.createElement("div",{style:{float:"left",width:"50%"}},s.createElement("div",{style:{fontSize:"12pt",fontWeight:"bold",textAlign:"left"}},t))),n&&this.renderErrorMsg(a),i?s.createElement(A.a,{size:S.a.large,labelPosition:"top",label:"Loading Experiments (with no activities)..."}):s.createElement("div",null,o.length>0?s.createElement("div",{style:{width:"90%",margin:"0 auto"}},s.createElement(Ze.a,{compact:!0,items:o,columns:this._getColumns(),onRenderRow:this._onRenderRow,constrainMode:Qe.d.horizontalConstrained,checkboxVisibility:Qe.a.always,onShouldVirtualize:function(){return!1},selectionMode:$e.b.none,selectionPreservedOnEmptyClick:!1,styles:ot})):s.createElement("span",null)))}}]),i}(s.Component);function st(e,t){var i={};return i.ExpId=e.ExperimentId,i.Expname=e.ExperimentName,i.ExpOwner=e.Owner,i.ExpStartDate=e.ExperimentStartDate?new Date(it()(e.ExperimentStartDate).format(N.a.DateFormats.NoTimeDate)):null,i.isEditable=function(e,t){return!!e.Owner&&e.Owner.toUpperCase()===t.userName.toUpperCase()||t.isAdmin}(e,t),i}Object(at.F)({fontSize:30,height:50,width:50,margin:"0 25px"});var ct,lt={headerWrapper:{selectors:{"& .ms-DetailsHeader-cell:hover":{backgroundColor:"white!important"}}}},dt=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e))._selection=void 0,n._onRenderGroupHeader=function(e){var t;return e?c.a.createElement("div",{onClick:n._onToggleCollapse(e),style:{fontSize:"12pt",textAlign:"left",padding:"10px",backgroundColor:"#4f4e4d",color:"#fff",cursor:"pointer"}},c.a.createElement(u.a,{iconName:e.group.isCollapsed?"ChevronRightMed":"ChevronDownMed",title:e.group.isCollapsed?"Expand":"Collapse",style:{color:"#fff",paddingRight:"10px"}}),"".concat(e.group.name),n.getEditExpLink(null===(t=e.group)||void 0===t?void 0:t.data)):null},n._onRenderRow=function(e){var t={};return e?(e.itemIndex%2===0&&(t.root={backgroundColor:"#ebe9e8"}),c.a.createElement(ze.a,Object.assign({},e,{styles:t}))):null},n._onToggleCollapse=function(e){return function(){e.onToggleCollapse(e.group)}},n._onItemSelectionChange=function(){var e=n._selection.getSelectedIndices();e.length>0?n.setState({selectedActivityIndex:n._selection.getSelectedIndices()[0],hideEditActBtn:1==e.length}):n.setState({selectedActivityIndex:-1,hideEditActBtn:!0,hideEditExpBtn:!0})},n._onAddActClick=function(){n.setState({redirectURI:"/PlanActivity"})},n._onEditActClick=function(){var e=n.state.selectedActivityIndex;n.setState({redirectURI:"/PlanActivity/"+e.toString()})},n._onAddExpClick=function(){n.setState({redirectURI:"/PlanExperiment"})},n._onEditExpClick=function(){},n._onActBtnClick=function(){var e=n.state.selectedActivityIndex;n.setState({redirectURI:e>=0?"/PlanActivity/"+e.toString():"/PlanActivity"})},n._onExpBtnClick=function(){var e=n.state.selectedActivityIndex;n.setState({redirectURI:e>=0?"/PlanExperiment/"+e.toString():"/PlanExperiment"})},n._onShowAllActivitiesChange=function(e){e.target.checked?n.setState({gridLabel:"All Activities",showAllActivities:!0,showAllActivitiesLoading:!0},(function(){n._getDataFromDB()})):n.setState({gridLabel:"My Activities",showAllActivities:!1,showAllActivitiesLoading:!0},(function(){n._getDataFromDB()}))},n._getDataFromDB=function(){var e=n.state.showAllActivities?null:n.context.userName;Ye.getActivitiesForUser(e,1,null).then((function(e){var t=e.data,i=function(e,t,i,a,n,o){var r={ItemsArr:[],GroupArr:[]},s=x.a.groupBy(e,t);if(s){for(var c=0,l=Object.keys(s),d=0;d<l.length;d++){var m=l[d],u="",p="",h={},v=0,f=!0,g=0,E=[];try{g=(E=x.a.orderBy(s[m],a)).length;var y=E[0];"null"===m?(u="Stand-alone"+d,p="Stand-alone Activities"):(u=m,p=i+y.ExperimentName,h=st(y,o)),v=c,f=!1,c+=g,r.GroupArr.push({key:u,name:p,startIndex:v,count:g,isCollapsed:f,data:h}),r.ItemsArr=r.ItemsArr.concat(E)}catch(A){console.log(A)}}r.GroupArr.sort((function(e,t){return e.data.ExpStartDate-t.data.ExpStartDate}))}return console.log("groupedGridItems",r),r}(n._groupActivitiesById(t),"ExperimentId","Experiment: ","ActivityDate",0,n.context),a=i.ItemsArr?n.state.gridLabel+" ("+i.ItemsArr.length.toString()+")":"";console.log("gridObj",i),n.setState({activities:i.ItemsArr,groups:i.GroupArr,isLoading:!1,showAllActivitiesLoading:!1,gridLabel:a,errorMessage:""})})).catch((function(e){n.setState({activities:[],isLoading:!1,showAllActivitiesLoading:!1,errorMessage:"Error Occured!\n"+e})}))},n._checkIfGroupedItemExists=function(e,t){var i=!1,a=e.split(",");return a&&a.length>0&&-1!==a.indexOf(t)&&(i=!0),i},n._groupActivitiesById=function(e){var t=[];return e.forEach((function(e,i){var a=t.filter((function(t){return t.ActivityId==e.ActivityId}));a.length<1?t.push(e):(a[0].ShiftName!=e.ShiftName&&null!=e.ShiftName&&(n._checkIfGroupedItemExists(a[0].ShiftName,e.ShiftName)||(a[0].ShiftName=a[0].ShiftName+","+e.ShiftName)),a[0].LocationName!=e.LocationName&&null!=e.LocationName&&(n._checkIfGroupedItemExists(a[0].LocationName,e.LocationName)||(a[0].LocationName=a[0].LocationName+","+e.LocationName)),a[0].EquipmentName!=e.EquipmentName&&null!=e.EquipmentName&&(n._checkIfGroupedItemExists(a[0].EquipmentName,e.EquipmentName)||(a[0].EquipmentName=a[0].EquipmentName+","+e.EquipmentName)))})),console.log(t),t},n._getGroups=function(e){var t=[];return e.length>0&&e.forEach((function(e,i){var a=e.ExperimentId?e.ExperimentId.toString():"noex",o=e.ExperimentName?"Experiment: "+e.ExperimentName:"Stand-alone Activities",r=t.filter((function(e){return e.key==a}));if(r.length>0)r[0].count++;else{var s=!!e.Owner&&e.Owner.toUpperCase()===n.context.userName.toUpperCase();s=(s=s||n.context.isAdmin)&&"noex"!==a,t.push({key:a,name:o,startIndex:i,count:1,data:s})}})),t},n._getEditLink=function(e){var t,i="/PlanActivity?id=";e.LocationName&&(-1!==(null===(t=e.LocationName)||void 0===t?void 0:t.split(",")).indexOf(N.a.ActivityForm.officeSpaceUsageLocationName)&&(i="/PlanOfficeSpace?id="));return i},n.checkIsPastRecord=function(e){var t=!0,i=it()(e.ActivityDate);return it()(new Date).diff(i,"days")>0&&(t=!1),t},n._getColumns=function(){return[{key:"Edit",name:"Edit",fieldName:"ActivityId",minWidth:50,maxWidth:50,onRender:function(e){var t,i=n._getEditLink(e);return c.a.createElement("div",null,n.checkIsPastRecord(e)&&(e.BookedByEmail.toUpperCase()===n.context.userName.toUpperCase()||e.BookedForEmail.toUpperCase()===n.context.userName.toUpperCase()||(null===(t=e.Owner)||void 0===t?void 0:t.toUpperCase())===n.context.userName.toUpperCase()||n.context.isAdmin)?c.a.createElement(et.a,{to:i+e.ActivityId.toString()},c.a.createElement(u.a,{iconName:"EditSolid12",title:"Edit Activity",style:{color:"#4f4e4d"}})):c.a.createElement(et.a,{to:i+e.ActivityId.toString()+"&view=1"},c.a.createElement(u.a,{iconName:"LockSolid",title:"View-Only Activity",style:{color:"#4f4e4d"}})))}},{key:"ActivityName",name:"Activity",fieldName:"ActivityName",minWidth:350,maxWidth:400},{key:"ActivityDate",name:"Date",fieldName:"ActivityDate",minWidth:60,maxWidth:70,onRender:function(e){return c.a.createElement("span",null,it.a.utc(e.ActivityDate).format("MM/DD/YYYY"))}},{key:"ShiftName",name:"Shift(s)",fieldName:"ShiftName",minWidth:150,maxWidth:170,onRender:function(e){if(e.ShiftName){var t=e.ShiftName.split(",");return c.a.createElement("div",null,t.map((function(e,t){return c.a.createElement("div",{key:t},e)})))}return c.a.createElement("span",null)}},{key:"LocationName",name:"Location(s)",fieldName:"LocationName",minWidth:100,maxWidth:120,onRender:function(e){if(e.LocationName){var t=e.LocationName.split(",");return c.a.createElement("div",null,t.map((function(e,t){return c.a.createElement("div",{key:t},e)})))}return c.a.createElement("span",null)}},{key:"EquipmentName",name:"Equipment(s)",fieldName:"EquipmentName",minWidth:150,maxWidth:170,onRender:function(e){if(e.EquipmentName){var t=e.EquipmentName.split(",");return c.a.createElement("div",null,t.map((function(e,t){return c.a.createElement("div",{key:t},e)})))}return c.a.createElement("span",null)}},{key:"BookedForEmail",name:"Person",fieldName:"BookedForEmail",minWidth:100,maxWidth:120}]},n._selection=new Je.a({onSelectionChanged:function(){return n._onItemSelectionChange()}}),i.contextType=fe.b,n.state={activities:[],groups:[],isLoading:!0,gridLabel:"My Activites",showAllActivities:!1,showAllActivitiesLoading:!1,selectedActivityIndex:-1,redirectURI:"",hideEditActBtn:!0,hideEditExpBtn:!0,errorMessage:""},n}return Object(n.a)(i,[{key:"render",value:function(){return c.a.createElement("div",{style:{width:"100%",textAlign:"center",overflow:"auto"}},c.a.createElement("div",{style:{width:"90%",display:"none"}},c.a.createElement("p",null,"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.")),c.a.createElement("div",{style:{width:"90%",overflow:"auto",margin:"0 auto",paddingBottom:"10px",paddingTop:"30px"}},c.a.createElement("div",{style:{float:"left",width:"20%"}},c.a.createElement("div",{style:{fontSize:"12pt",fontWeight:"bold",textAlign:"left"}},this.state.gridLabel)),c.a.createElement("div",{style:{float:"right",width:"80%"}},c.a.createElement("div",{style:{float:"right",paddingTop:"5px",paddingLeft:"5px"}},c.a.createElement(Xe.a,{label:"Show all activities",onChange:this._onShowAllActivitiesChange,style:{float:"right"}})),c.a.createElement("div",{style:{float:"right",paddingTop:"5px"}},this.state.showAllActivitiesLoading&&c.a.createElement(A.a,{size:S.a.small})))),this.state.activities.length>0?c.a.createElement("div",{style:{width:"90%",margin:"0 auto"}},c.a.createElement(Ze.a,{compact:!0,items:this.state.activities,columns:this._getColumns(),groups:this.state.groups,groupProps:{onRenderHeader:this._onRenderGroupHeader},onRenderRow:this._onRenderRow,constrainMode:Qe.d.horizontalConstrained,checkboxVisibility:Qe.a.always,onShouldVirtualize:function(){return!1},selection:this._selection,selectionMode:$e.b.none,selectionPreservedOnEmptyClick:!1,styles:lt})):c.a.createElement("span",null),c.a.createElement("div",{style:{}},this.state.isLoading&&c.a.createElement(A.a,{size:S.a.large,labelPosition:"top",label:"Loading activities..."})),""!==this.state.errorMessage?c.a.createElement("div",{style:{color:"red"}},this.state.errorMessage):"",""!=this.state.redirectURI?c.a.createElement(d.a,{to:this.state.redirectURI}):"",c.a.createElement(rt,null))}},{key:"getEditExpLink",value:function(e){return e&&Object.keys(e).length>0?e.isEditable?c.a.createElement(et.a,{style:{fontSize:"12pt",paddingLeft:"20px"},to:"/PlanExperiment?id="+e.ExpId},c.a.createElement(u.a,{iconName:"Edit",title:"Edit Experiment",style:{color:"#fff"}})):c.a.createElement(et.a,{style:{fontSize:"12pt",paddingLeft:"20px"},to:"/PlanExperiment?id="+e.ExpId+"&view=1"},c.a.createElement(u.a,{iconName:"LockSolid",title:"View-Only Experiment",style:{color:"#fff"}})):c.a.createElement(c.a.Fragment,null)}},{key:"componentDidMount",value:function(){this._getDataFromDB()}}]),i}(c.a.Component),mt=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).state={},n.props.handleRedirection("5"),n}return Object(n.a)(i,[{key:"render",value:function(){return s.createElement(dt,null)}}]),i}(s.Component),ut=i(312),pt=i(50),ht=(i(254),{ExperimentName:"",StartDate:"",Remarks:"",ExperimentOwner:"",ProjectId:""}),vt=function(e){var t={isValid:!0,ErrorMsgs:Object(v.a)({},ht)};try{isNaN(new Date(e.StartDate).getTime())&&(t.ErrorMsgs.StartDate="Activity Date is required field.",t.isValid=!1),e.ProjectId||(t.ErrorMsgs.ProjectId="Project/Study is required field.",t.isValid=!1),e.Name?""===e.Name.trim()&&(t.ErrorMsgs.ExperimentName="Experiment Name cannot be empty.",t.isValid=!1):(t.ErrorMsgs.ExperimentName="Experiment Name is required field.",t.isValid=!1),e.Owner.length<1&&(t.ErrorMsgs.ExperimentOwner="Experiment Owner is required field.",t.isValid=!1)}catch(i){console.log(i),t.isValid=!1}return t},ft=i(65);!function(e){e.AddExperiment="You will be able to add activities after you save the experiment.",e.NoActivities="Click on Add Activity button to add the first activity to this experiment.",e.NoEditPastExp="The system doesn't allow updates to Experiment Details which have start dates in the past!",e.NoAdminExpOwner="Permission Denied: Only a system administrator or the experiment owner can edit an experiment.",e.UnsavedChangesLost="Your unsaved changes in the experiment details section will be lost. Do you still want to close?",e.ExptDetailsSaved="Experiment details saved successfully.",e.DeleteActToolTip="Enabled if none of the selected activities occur in the past.",e.DeleteExptConfirm="Are you sure you want to delete this experiment and all associated activities?",e.DeleteActConfirm="Are you sure you want to delete the selected activity/activities?",e.DeleteNotesError="Please mention the reason for deleting this experiment.",e.DeletedExperiment="Deleted experiments can't be edited.",e.NoExperimentWithId="Couldn't find an experiment with this id",e.LoadingActivitForm="Loading Activity Form...",e.CloneActivitForm="Cloning Activity...",e.CreatedActivity="Please fill all the required fields before saving the experiment.",e.ReloadActivity="Reloading Activities..",e.DeleteActivity="Deleting...",e.UnsavedEditForm="Unsaved changes in the Edit form will be lost. Do you confirm?",e.UnsavedAddForm="Unsaved changes in the Add form will be lost. Do you confirm?",e.UnsavedAddEditForm="Unsaved changes in the Add/Edit form will be lost. Do you confirm?",e.UnsavedAddEditFormViewClick="Unsaved changes in the Add/Edit form will be lost. Do you confirm?",e.CloneExpConfirmation="This will create a copy of this experiment and take you there so you can update the date and other details. Do you want to proceed?",e.CloneActConfirmation="This will create a copy of this activity and display it below so you can update the date and other details. Do you want to proceed?",e.CloneSuccessMessage="Experiment Cloned successfully. You can update the dates and other details of the cloned experiment here.",e.CloningExpLoaderTxt="Cloning..."}(ct||(ct={}));var gt={headerWrapper:{selectors:{"& .ms-DetailsHeader-cell:hover":{backgroundColor:"white!important"}}}},Et=it()().format(N.a.PlanExperiment.ExpDateFormat),yt=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e))._selection=void 0,n.sortActivities=function(e){return D.orderBy(e,(function(e,t){return new Date(e.ActivityDate)}))},n.loadSpinner=function(e,t){return s.createElement("div",{className:"centeredContainer"},s.createElement(ve.a,{label:e,hideDialog:!t}))},n.handleActivityActions=function(e,t){switch(t){case"LoadForm":n.setState({FormActionLoading:!1,FormAction:"LoadForm",InfoMessage:ct.NoActivities});break;case"CloseForm":n.setState({ShowAddActivity:"None",FormActionLoading:!1,FormAction:"LoadForm",InfoMessage:ct.NoActivities});break;case"CreatedActivity":n.reloadActivityGrid(),n.setState({ShowAddActivity:"None",FormAction:"ShowMessage",FormActionMsg:"Created Activity Successfully!"}),setTimeout((function(){n.setState({FormActionMsg:""})}),2500);break;case"UpdatedActivity":n.reloadActivityGrid(),n.setState({ShowAddActivity:"None",FormAction:"ShowMessage",FormActionMsg:"Updated Activity Successfully!"}),setTimeout((function(){n.setState({FormActionMsg:""})}),2500);break;case"ClonedActivity":n.reloadActivityGrid(),n.setState({ShowAddActivity:"Edit",AID:parseInt(e),FormAction:"ShowMessage",FormActionMsg:"Cloned Activity Successfully. Opened Edit activity form of the cloned activity"}),setTimeout((function(){n.setState({FormActionMsg:""})}),2500);break;case"DeleteActivity":n.reloadActivityGrid(),n.setState({ShowAddActivity:"None",AID:parseInt(e),FormAction:"ShowMessage",FormActionMsg:"Deleted Activity Successfully.  "}),setTimeout((function(){n.setState({FormActionMsg:""})}),2500);break;case"ViewToEdit":n.setState({ShowAddActivity:"Edit"})}},n.deleteMulActivities=function(){var e=n.state,t=e.SelectedActivities,i=e.Experiment;if(t.length>0){var a="Delete activities from experiment "+i.Id+" by "+n.context.userName,o=D.map(t,"ActivityId");n.setState({InfoMessage:ct.DeleteActivity,FormActionLoading:!0,ShowDialog:"None",ShowAddActivity:"None"}),M.deleteActivities({ActivityIds:o,Notes:a}).then((function(e){n.reloadActivityGrid(),n.setState({ShowAddActivity:"None",Mode:"EDIT",InfoMessage:"",FormActionLoading:!1})}))}else n.setState({ShowDialog:"None"})},n.onClickDeleteMulActivities=function(){n.state.ShowAddActivity;var e=!0;e&&(e=!1,n.setState({ShowDialog:"DeletePrompt"}))},n.addActClickState=function(){n.setState({ShowAddActivity:"Add",FormActionLoading:!0,FormAction:"LoadForm",ShowDialog:"None",FormId:ft(),InfoMessage:ct.LoadingActivitForm})},n.onClickAddActivity=function(e){var t=!0;"Edit"===n.state.ShowAddActivity&&(t=!1,n.setState({ShowDialog:"UnsavedEditForm"})),t&&n.addActClickState()},n.viewActClickState=function(){var e=n.state.SelectedActivities,t=e.length>0?e[0].ActivityId:0;n.setState({ShowAddActivity:"View",FormActionLoading:!0,AID:t,ShowDialog:"None",FormAction:"LoadForm",FormId:ft(),InfoMessage:ct.LoadingActivitForm})},n.onClickViewActivity=function(e){var t=n.state.ShowAddActivity,i=!0;"Edit"!==t&&"Add"!==t||(i=!1,n.setState({ShowDialog:"UnsavedAddEditFormViewClick"})),i&&n.viewActClickState()},n.editActClickState=function(){var e=n.state.SelectedActivities,t=e.length>0?e[0].ActivityId:0;n.setState({ShowAddActivity:"Edit",FormActionLoading:!0,AID:t,ShowDialog:"None",FormAction:"LoadForm",FormId:ft(),InfoMessage:ct.LoadingActivitForm})},n.onClickEditActivity=function(e){var t=!0;"Add"===n.state.ShowAddActivity&&(t=!1,n.setState({ShowDialog:"UnsavedAddForm"})),t&&n.editActClickState()},n.cloneActClickState=function(){var e=n.state,t=e.SelectedActivities,i=(e.Experiment,t.length>0?t[0].ActivityId:0);n.setState({FormActionLoading:!0,FormAction:"LoadForm",ShowAddActivity:"None",ShowDialog:"None",InfoMessage:ct.CloneActivitForm});var a={ActivityId:i};M.CloneActivity(a).then((function(e){e&&e.id&&(n.reloadActivityGrid(),n.setState({ShowAddActivity:"Edit",FormActionLoading:!0,AID:e.id,FormAction:"LoadForm",FormId:ft(),InfoMessage:ct.LoadingActivitForm}))})).catch((function(e){console.log("Clone act error",e)}))},n.onClickCloneActivity=function(e){var t=n.state.ShowAddActivity,i=!0;"Add"!==t&&"Edit"!==t||(i=!1,n.setState({ShowDialog:"UnsavedAddEditForm"})),i&&(i=!1,n.setState({ShowDialog:"CloneActConfirmation"})),i&&n.cloneActClickState()},n.toggleHideDialog=function(){n.setState({ShowDialog:"None"})},n.confirmationAction=function(){switch(n.state.ShowDialog){case"UnsavedEditForm":n.addActClickState();break;case"UnsavedAddForm":n.editActClickState();break;case"UnsavedAddEditFormViewClick":n.viewActClickState();break;case"UnsavedAddEditForm":n.setState({ShowAddActivity:"None",ShowDialog:"CloneActConfirmation"});break;case"CloneActConfirmation":n.cloneActClickState();break;case"CloseExpForm":n.setState({RedirectUri:"/Home"});break;case"DeletePrompt":n.deleteMulActivities();break;default:n.toggleHideDialog()}},n.renderConfirm=function(){var e={type:xe.a.normal,title:"Missing Subject",closeButtonAriaLabel:"Close",subText:"Do you want to send this message without a subject?"},t=!0;switch(n.state.ShowDialog){case"None":e.title="",e.subText="",t=!0;break;case"UnsavedEditForm":e.title="Unsaved Edit Form",e.subText=ct.UnsavedEditForm,t=!1;break;case"UnsavedAddForm":e.title="Unsaved Add Form",e.subText=ct.UnsavedAddForm,t=!1;break;case"UnsavedAddEditFormViewClick":e.title="Unsaved Add/Edit Form",e.subText=ct.UnsavedAddEditFormViewClick,t=!1;break;case"UnsavedAddEditForm":e.title="Unsaved Add/Edit Form",e.subText=ct.UnsavedAddEditForm,t=!1;break;case"CloneActConfirmation":e.title="Clone?",e.subText=ct.CloneActConfirmation,t=!1;break;case"CloseExpForm":e.title="Unsaved Form",e.subText=ct.UnsavedChangesLost,t=!1;break;case"DeletePrompt":e.title="Delete?",e.subText=ct.DeleteActConfirm,t=!1}return s.createElement(s.Fragment,null,s.createElement(De.a,{hidden:t,onDismiss:n.toggleHideDialog,dialogContentProps:e,modalProps:{isBlocking:!0}},s.createElement(Ne.a,null,s.createElement(Ae.a,{onClick:n.confirmationAction.bind(Object(Ue.a)(n)),text:"Yes"}),s.createElement(Ce.a,{onClick:n.toggleHideDialog.bind(Object(Ue.a)(n)),text:"No"}))))},n.loadMasterData=function(){return new Promise((function(e,t){M.getProjects().then((function(t){var i=t.data;n.setState({Projects:i}),e(!0)})).catch((function(e){console.log(e),t(e)}))}))},n.validateForm=function(){var e=n.state,t=e.Mode,i=e.Experiment;if(pt.c(t,"EDIT"))if(1!==i.StatusId)n.setState({DisableForm:!0,DisableAdd:!0,HeaderMessage:ct.DeletedExperiment,HeaderMessageType:E.a.error});else{var a=it()(i.StartDate);it()(new Date).diff(a,"days")>0&&n.setState({DisableForm:!0,HeaderMessage:ct.NoEditPastExp,HeaderMessageType:E.a.error}),n.context.isAdmin||pt.c(n.context.userName,i.Owner[0].Email)||n.setState({DisableForm:!0,DisableAdd:!0,HeaderMessage:ct.NoAdminExpOwner,HeaderMessageType:E.a.error})}},n.setCurrentUserAsOwner=function(){var e={};return e.DisplayName=n.context.name,e.Email=n.context.userName,e},n.loadAddForm=function(){var e=n.state.Experiment;e.Owner=[];var t=n.setCurrentUserAsOwner();e.Owner.push(t),e.StartDate=new Date(Et),n.setState({Mode:"add",Experiment:e,PlanexLoading:!1})},n.loadEditForm=function(e){var t=[];t.push(M.getExperiment(e)),t.push(M.getActivitiesForExp(e)),Promise.all(t).then((function(e){if(null!=e[0]){if(e&&e.length>0){var t=e[0],i=[];e.length>1&&(i=e[1]),n.setState({PlanexLoading:!1,FormActionLoading:!1,InfoMessage:"",Experiment:t,ExperimentActivities:n.reduecActivityArray(Object(f.a)(i)),PreviousStartDate:t.StartDate},(function(){n.validateForm()}))}}else n.setState({PlanexLoading:!1,DisableForm:!0,HeaderMessage:ct.NoExperimentWithId,HeaderMessageType:E.a.error})})).catch((function(e){console.log(e)}))},n.reduecActivityArray=function(e){var t=[];return e.length>0&&e.forEach((function(e,i){var a=t.filter((function(t){return t.ActivityId==e.ActivityId}));1!==a.length?t.push(e):(a[0].ShiftName=n.checkAndReduceField(a[0],"ShiftName",e.ShiftName),a[0].LocationName=n.checkAndReduceField(a[0],"LocationName",e.LocationName),a[0].EquipmentName=n.checkAndReduceField(a[0],"EquipmentName",e.EquipmentName))})),n.sortActivities(t)},n.checkAndReduceField=function(e,t,i){switch(t){case"ShiftName":return null!=e.ShiftName&&e.ShiftName.split("|").indexOf(i)<0?e.ShiftName+"|"+i:e.ShiftName;case"LocationName":return null!=e.LocationName&&e.LocationName.split("|").indexOf(i)<0?e.LocationName+"|"+i:e.LocationName;case"EquipmentName":return null!=e.EquipmentName&&e.EquipmentName.split("|").indexOf(i)<0?e.EquipmentName+"|"+i:e.EquipmentName;default:return""}},n._onItemSelectionChange=function(){var e=n.state.ExperimentActivities,t=n._selection.getSelectedIndices(),i=[],a=!1;t.map((function(t){i.push(e[t]);var n=it()(e[t].ActivityDate);it()(new Date).diff(n,"days")>0&&(a=!0)})),n.setState({SelectedActivities:i,DisableDelete:a})},n.onChangeExperimentName=function(e){var t=n.state.Experiment;t.Name=e.target.value,n.setState({Experiment:t,ExperimentNotSaved:!0})},n.onProjectChange=function(e,t,i){if(t){var a=n.state.Experiment;a.ProjectId=parseInt(t.key.toString()),n.setState({Experiment:a,ExperimentNotSaved:!0})}},n.onSelectExpDate=function(e){if(e){var t=n.state.Experiment,i=t.StartDate;t.StartDate=e,n.setState({Experiment:t,PreviousStartDate:i,ExperimentNotSaved:!0})}},n.onSelectExperimentOwner=function(e,t){var i=n.state.Experiment;i.Owner=e.length>0?e:[],n.setState({Experiment:i,ExperimentNotSaved:!0})},n.onChangeExperimentDesc=function(e){var t=n.state.Experiment;t.Description=e.target.value,n.setState({Experiment:t,ExperimentNotSaved:!0})},n.onDeleteExperiment=function(e){window.confirm(ct.DeleteExptConfirm)},n.onCloseExperiment=function(e){var t=n.state,i=t.ExperimentNotSaved,a=t.ShowAddActivity;i||"Edit"===a||"Add"===a?n.setState({ShowDialog:"CloseExpForm"}):n.setState({RedirectUri:"/Home"})},n.onSaveExperiment=function(e){e.preventDefault();var t=n.state.Mode;if(pt.c(t,"ADD")){var i=n.state.Experiment,a=vt(i);a.isValid?(n.setState({SaveExpProcessing:!0}),M.addExperiment(i).then((function(e){var t=n.state.Experiment;t.Id=e.output.ExperimentId,t.StatusId=1,n.setState({Experiment:t,EID:t.Id,Mode:"EDIT",SaveExpProcessing:!1,ExperimentErrMsgs:a.ErrorMsgs,InfoMessage:ct.NoActivities,RedirectUri:"/PlanExperiment?id="+e.output.ExperimentId,TopLabel:"Edit Experiment",ExperimentNotSaved:!1,HeaderMessage:ct.ExptDetailsSaved,HeaderMessageType:E.a.success})})).then((function(){n.validateForm()}))):n.setState({ExperimentErrMsgs:a.ErrorMsgs})}else if(pt.c(t,"EDIT")){var o=n.state.Experiment;vt(o).isValid&&(n.setState({SaveExpProcessing:!0}),o.UpdateActivities=o.StartDate!==n.state.PreviousStartDate,M.updateExperiment(o).then((function(e){if(console.log(e),e.length>0){var t=e[0];n.setState({Mode:"EDIT",SaveExpProcessing:!1,ExperimentActivities:n.reduecActivityArray(Object(f.a)(t)),ExperimentNotSaved:!1,FormId:ft()})}else n.setState({Mode:"EDIT",SaveExpProcessing:!1,ExperimentNotSaved:!1})})).then((function(){n.validateForm()})))}},n.onDismissHeaderMessage=function(e){n.setState({HeaderMessage:""})},n.onClickDeleteExp=function(){var e=n.state.HideDeleteDialog;n.setState({HideDeleteDialog:!e,DeleteNotes:""})},n.onChangeDeleteNotes=function(e){n.setState({DeleteNotes:e.target.value})},n.onClickDeleteConfirmation=function(){var e=n.state.DeleteNotes;if(e.trim().length>0){var t=e+" - Deleted by "+n.context.userName;M.deleteExperiment(n.state.Experiment.Id,t).then((function(e){n.setState({DeleteNotes:"",HideDeleteDialog:!0,DisableForm:!0,HeaderMessage:"Experiment deleted successfully. "+ct.DeletedExperiment,HeaderMessageType:E.a.error})})).catch((function(e){n.setState({HideDeleteDialog:!0,HeaderMessage:N.a.ActivityForm.DeleteErrorMessage+e}),console.log(e)}))}else n.setState({HideDeleteDialog:!1,DeleteErrorMessage:ct.DeleteNotesError})},n.onClickCloneExperiment=function(e){var t=n.state.HideCloneDialog;n.setState({HideCloneDialog:!t})},n.onClickConfirmCloneExperiment=function(e){var t=n.state,i=t.HideCloneDialog,a=t.Experiment;n.setState({HideCloneDialog:!i,FormActionLoading:!0,InfoMessage:ct.CloningExpLoaderTxt}),M.cloneExperiment(a.Id).then((function(e){var t="/PlanExperiment?id="+e.CloneExpId+"&ParentId="+a.Id;n.setState({RedirectUri:t,DisableForm:!1,InfoMessage:"Loading...",HeaderMessageType:E.a.success,HeaderMessage:ct.CloneSuccessMessage})}))},n.getActivityColumns=function(){return[{key:"ActivityDate",name:"Date",fieldName:"ActivityDate",minWidth:90,maxWidth:110,onRender:function(e){return s.createElement("div",null,it.a.utc(e.ActivityDate).format("MM/DD/YYYY"))}},{key:"ActivityName",name:"Activity Name",fieldName:"ActivityName",minWidth:200,maxWidth:250},{key:"ShiftName",name:"Shift(s)",fieldName:"ShiftName",minWidth:150,maxWidth:180,onRender:function(e){return e.ShiftName?s.createElement("div",null,e.ShiftName.split("|").map((function(e,t){return s.createElement("div",{key:t},e)}))):s.createElement("span",null)}},{key:"LocationName",name:"Location(s)",fieldName:"LocationName",minWidth:150,maxWidth:180,onRender:function(e){return e.LocationName?s.createElement("div",null,e.LocationName.split("|").map((function(e,t){return s.createElement("div",{key:t},e)}))):s.createElement("span",null)}},{key:"EquipmentName",name:"Equipment(s)",fieldName:"EquipmentName",minWidth:150,maxWidth:180,onRender:function(e){return e.EquipmentName?s.createElement("div",null,e.EquipmentName.split("|").map((function(e,t){return s.createElement("div",{key:t},e)}))):s.createElement("span",null)}},{key:"BookedForName",name:"Person",fieldName:"BookedForName",minWidth:200,maxWidth:220},{key:"ActivityDescription",name:"Description",fieldName:"ActivityDescription",minWidth:200,maxWidth:250}]},n._selection=new Je.a({onSelectionChanged:function(){return n._onItemSelectionChange()}}),i.contextType=fe.b,n.state={Experiment:{},ExperimentErrMsgs:{},TopLabel:"Add Experiment",Projects:[],ExperimentActivities:[],ShowAddActivity:"None",ShowDialog:"None",PlanActivityLabel:"Add An Activity",InfoMessage:ct.AddExperiment,Mode:"add",EID:0,AID:0,SaveExpProcessing:!1,RedirectUri:"",PlanexLoading:!0,HeaderMessage:"",HeaderMessageType:E.a.error,DisableForm:!1,DisableAdd:!1,DisableDelete:!1,SelectedActivities:[],PreviousStartDate:new Date(Et),ExperimentNotSaved:!1,HideDeleteDialog:!0,DeleteNotes:"",DeleteErrorMessage:"",FormActionLoading:!1,FormAction:"LoadForm",FormActionMsg:"",FormId:ft(),HideCloneDialog:!0},n}return Object(n.a)(i,[{key:"render",value:function(){var e,t,i=this.state,a=i.ShowDialog,n=i.HeaderMessage,o=i.HeaderMessageType,r=i.HideDeleteDialog,c=i.DeleteNotes,l=i.DeleteErrorMessage,m=i.Experiment,u=i.EID,p=i.TopLabel,h=i.Projects,v=i.ExperimentActivities,f=i.ShowAddActivity,E=i.InfoMessage,D=i.Mode,x=i.SaveExpProcessing,N=i.FormActionLoading,C=i.FormActionMsg,I=i.ExperimentNotSaved,b=i.RedirectUri,w=i.PlanexLoading,k=i.ExperimentErrMsgs,F=i.DisableForm,T=i.SelectedActivities,L=i.AID,O=i.FormId,M=i.HideCloneDialog,P=i.DisableAdd,R=i.DisableDelete,B=m.StartDate?m.StartDate:null;return s.createElement("div",{style:{width:"100%",textAlign:"center",overflow:"auto"}},w?s.createElement("div",{style:{paddingTop:"50px"}},s.createElement(A.a,{type:S.b.large,label:"Loading..."})):s.createElement("div",{className:"ms-Grid"},s.createElement("div",{className:"ms-Grid-row",style:{minHeight:"30px"}}),n?s.createElement("div",{className:"ms-Grid-row",style:{width:"90%",overflow:"auto",margin:"0 auto",padding:"0px 0px 10px 0px"}},s.createElement(g.a,{key:"HeaderMessageType",onDismiss:this.onDismissHeaderMessage,messageBarType:o,dismissButtonAriaLabel:"Close"},n)):"",s.createElement("div",{className:"ms-Grid-row",style:{boxShadow:"rgba(0, 0, 0, 0.133) 0px 1.6px 3.6px 0px, rgba(0, 0, 0, 0.11) 0px 0.3px 0.9px 0px",width:"90%",overflow:"auto",margin:"0 auto",padding:"10px 0px 10px 10px"}},s.createElement("div",{className:"ms-Grid",dir:"ltr",style:{padding:"0px",width:"99%",textAlign:"left"}},s.createElement("div",{className:"ms-Grid-row",style:{width:"100%",overflow:"auto",margin:"0 auto",paddingBottom:"10px"}},s.createElement("div",{className:"ms-Grid-col ms-sm4 ms-md4 ms-lg4",style:{padding:"0px"}},s.createElement("div",{style:{fontSize:"12pt",fontWeight:"bold",textAlign:"left"}},p)),s.createElement("div",{className:"ms-Grid-col ms-sm8 ms-md8 ms-lg8",style:{padding:"0px"}},pt.c(D,"EDIT")?s.createElement("div",{style:{float:"right",paddingLeft:"15px"}},s.createElement(ke,{key:"Delete",CustClassName:"BlockingDialog",iconString:"Delete",hideDialog:r,buttonTxt:"Delete",onBtnClick:this.onClickDeleteExp,buttonType:"Primary",dialogTitle:"Delete",subText:"Are you sure you want to delete the experiment and associated activities?",isBlocking:!0,handleAction:this.onClickDeleteConfirmation,actionBtnTxt:"Delete",disabled:F,dismisBtnTxt:"Cancel"},s.createElement("div",null,s.createElement(y.a,{multiline:!0,label:"Notes",name:"deleteNotes",placeholder:"Reason for deleting",value:c,errorMessage:l,onChange:this.onChangeDeleteNotes})))):"",pt.c(D,"EDIT")?s.createElement("div",{style:{float:"right",paddingLeft:"15px"}},s.createElement(ke,{key:"Clone",CustClassName:"BlockingDialog",iconString:"Clone",hideDialog:M,buttonTxt:"Clone Experiment",onBtnClick:this.onClickCloneExperiment,buttonType:"Primary",dialogTitle:"Clone Experiment?",subText:"This will create a copy of this experiment with all its activities. Do you want to proceed?",isBlocking:!1,handleAction:this.onClickConfirmCloneExperiment,actionBtnTxt:"OK",dismisBtnTxt:"Cancel"})):"",s.createElement("div",{style:{float:"right",paddingLeft:"15px"}},s.createElement(Ae.a,{text:"Close",onClick:this.onCloseExperiment})),s.createElement("div",{style:{float:"right",paddingLeft:"15px"}},s.createElement(Ae.a,{text:"Save",disabled:F,onClick:this.onSaveExperiment})),s.createElement("div",{style:{float:"right",paddingLeft:"15px"}},!x||s.createElement(A.a,{type:S.b.large,hidden:!1})))),s.createElement("div",{className:"ms-Grid-row"},s.createElement("div",{className:"ms-Grid-col ms-sm5 ms-md5 ms-lg5"},s.createElement(y.a,{disabled:F,required:!0,label:"Experiment Name",errorMessage:k.ExperimentName,value:m.Name,onChange:this.onChangeExperimentName})),s.createElement("div",{className:"ms-Grid-col ms-sm2 ms-md2 ms-lg2"},s.createElement(ut.a,{disabled:F,required:!0,errorMessage:k.ProjectId,label:"Project / Study",selectedKey:m.ProjectId,options:null===h||void 0===h?void 0:h.map((function(e,t){return{key:e.Id,text:e.Name}})),onChange:this.onProjectChange})),s.createElement("div",{className:"ms-Grid-col ms-sm2 ms-md2 ms-lg2"},s.createElement(W.a,{viewForm:F,required:!0,showNonFormLabel:!1,labelHead:"Start Date",dateInput:B,updateFunc:this.onSelectExpDate}),k.StartDate?this.renderErrorMsgForField(k.StartDate,"StartDate"):""),s.createElement("div",{className:"ms-Grid-col ms-sm3 ms-md3 ms-lg3"},s.createElement(Y.a,{className:"requiredLabel"},"Experiment Owner"),s.createElement("div",{style:{backgroundColor:"#fff"}},s.createElement(de,{viewForm:F,required:!0,description:"Set an experiment owner",placeholderTxt:"Start typing the name to search",property:"ExperimentOwner",updatePeoplePickerChange:this.onSelectExperimentOwner,people:m.Owner?m.Owner:[]})),k.ExperimentOwner?this.renderErrorMsgForField(k.ExperimentOwner,"ExperimentOwner"):"")),s.createElement("div",{className:"ms-Grid-row"},s.createElement("div",{className:"ms-Grid-col ms-sm12 ms-md12 ms-lg12"},s.createElement(y.a,{disabled:F,label:"Description",value:m.Description,onChange:this.onChangeExperimentDesc}))))),s.createElement("div",{className:"ms-Grid-row",style:{minHeight:"20px"}}),s.createElement("div",{className:"ms-Grid-row",style:{boxShadow:"rgba(0, 0, 0, 0.133) 0px 1.6px 3.6px 0px, rgba(0, 0, 0, 0.11) 0px 0.3px 0.9px 0px",width:"90%",overflow:"auto",margin:"0 auto",padding:"10px 0px 10px 10px"}},s.createElement("div",{className:"ms-Grid",dir:"ltr",style:{padding:"0px",width:"99%",textAlign:"left"}},s.createElement("div",{className:"ms-Grid-row",style:{width:"100%",overflow:"auto",margin:"0 auto",paddingBottom:"10px"}},s.createElement("div",{className:"ms-Grid-col ms-sm4 ms-md4 ms-lg4",style:{padding:"0px"}},s.createElement("div",{style:{fontSize:"12pt",fontWeight:"bold",textAlign:"left"}},"Activities")),pt.c(D,"add")?"":s.createElement("div",{className:"ms-Grid-col ms-sm8 ms-md8 ms-lg8",style:{padding:"0px"}},s.createElement("div",{style:{float:"right",marginLeft:"15px"},title:ct.DeleteActToolTip},s.createElement(Ae.a,{text:"Delete Activity",disabled:0===v.length||0===T.length||R,onClick:this.onClickDeleteMulActivities})),s.createElement("div",{style:{float:"right",paddingLeft:"15px"}},s.createElement(Ae.a,{text:"Clone Activity",disabled:P||0===v.length||1!==T.length,onClick:this.onClickCloneActivity})),s.createElement("div",{style:{float:"right",paddingLeft:"15px"}},s.createElement(Ae.a,{text:"Edit Activity",disabled:0===v.length||1!==T.length,onClick:this.onClickEditActivity})),s.createElement("div",{style:{float:"right",paddingLeft:"15px"}},s.createElement(Ae.a,{text:"View Activity",disabled:0===v.length||1!==T.length,onClick:this.onClickViewActivity})),s.createElement("div",{style:{float:"right",paddingLeft:"15px"}},s.createElement(Ae.a,{text:"Add Activity",disabled:P||"Add"===f,onClick:this.onClickAddActivity}))),"None"===a?"":this.renderConfirm()),s.createElement("div",{className:"ms-Grid-row"},C?this.renderTimmerMessages(C):"",N?this.loadSpinner(E,N):""),s.createElement("div",{className:"ms-Grid-row",style:{width:"100%",overflow:"auto",margin:"0 auto",paddingBottom:"10px"}},s.createElement("div",{className:"ms-Grid-col ms-sm12 ms-md12 ms-lg12",style:{padding:"0px"}},v.length>0?s.createElement(Ze.a,{items:v,columns:this.getActivityColumns(),constrainMode:Qe.d.horizontalConstrained,checkboxVisibility:Qe.a.always,onShouldVirtualize:function(){return!1},selection:this._selection,selectionMode:$e.b.multiple,selectionPreservedOnEmptyClick:!1,styles:gt}):s.createElement("span",null,E))))),s.createElement("div",{className:"ms-Grid-row",style:{minHeight:"20px"}}),s.createElement("div",{className:"ms-Grid-row",style:{boxShadow:"rgba(0, 0, 0, 0.133) 0px 1.6px 3.6px 0px, rgba(0, 0, 0, 0.11) 0px 0.3px 0.9px 0px",width:"90%",overflow:"auto",margin:"0 auto",padding:"10px 0px 00px 10px"}},"Add"===f?s.createElement("div",{className:"ms-Grid",dir:"ltr",style:{padding:"0px",width:"99%",textAlign:"left"}},s.createElement("div",{className:"ms-Grid-row",style:{width:"100%",overflow:"auto",margin:"0 auto",paddingBottom:"0px"}},s.createElement("div",{className:"ms-Grid-col ms-sm12 ms-md12 ms-lg12",style:{padding:"0px"}},s.createElement(Pe,{key:"Create"+O,handleActivityActions:this.handleActivityActions,NotPopActions:!0,ExpData:{ExpId:u,ExpOwnerEmail:null===(e=m.Owner[0])||void 0===e?void 0:e.Email,ExpStartDate:m.StartDate,ExperimentNotSaved:I}})))):"","Edit"===f||"View"===f?s.createElement("div",{className:"ms-Grid",dir:"ltr",style:{padding:"0px",width:"99%",textAlign:"left"}},s.createElement("div",{className:"ms-Grid-row",style:{width:"100%",overflow:"auto",margin:"0 auto",paddingBottom:"0px"}},s.createElement("div",{className:"ms-Grid-col ms-sm12 ms-md12 ms-lg12",style:{padding:"0px"}},s.createElement(Ve,{key:"Edit"+O,Id:L,viewForm:"View"===f,handleActivityActions:this.handleActivityActions,NotPopActions:!0,ExpData:{ExpId:u,ExpOwnerEmail:null===(t=m.Owner[0])||void 0===t?void 0:t.Email,ExpStartDate:m.StartDate,ExperimentNotSaved:I}})))):"")),b?s.createElement(d.a,{to:b}):"")}},{key:"renderErrorMsgForField",value:function(e,t){return s.createElement("div",{role:"alert",key:t},s.createElement("p",{className:"ms-TextField-errorMessage alertMsg"},s.createElement("span",{"data-automation-id":"error-message"},e)))}},{key:"reloadActivityGrid",value:function(){var e=this,t=this.state.Experiment;this.setState({FormActionLoading:!0,InfoMessage:ct.ReloadActivity}),M.getActivitiesForExp(t.Id).then((function(t){if(t){var i;i=t,e.setState({PlanexLoading:!1,InfoMessage:"",FormActionLoading:!1,ExperimentActivities:e.reduecActivityArray(Object(f.a)(i))})}}))}},{key:"renderTimmerMessages",value:function(e){return s.createElement(g.a,{messageBarType:E.a.success,className:"formupdateInfo"},e)}},{key:"componentDidMount",value:function(){var e=this;this.loadMasterData().then((function(t){var i=e.props,a=i.FormMode,n=i.ExpId;switch(a.toUpperCase()){case"ADD":e.loadAddForm();break;case"EDIT":e.loadEditForm(n),e.setState({Mode:"edit",EID:n,TopLabel:"Edit Experiment"})}}))}},{key:"componentDidUpdate",value:function(e,t){this.state.Experiment;this.props.ExpId!==e.ExpId&&this.props.ParentId!==e.ParentId&&(this.loadEditForm(this.props.ExpId),this.setState({Mode:"edit",FormActionLoading:!0,InfoMessage:"Loading...",EID:this.props.ExpId,TopLabel:"Edit Experiment"}))}}]),i}(s.Component),At=i(65),St=function(e){Object(o.a)(i,e);var t=Object(r.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).state={isViewForm:!1,isNewForm:!0,itemId:"0",ParentId:"0",formKey:At()},n.props.handleRedirection("1"),n}return Object(n.a)(i,[{key:"render",value:function(){var e=this.state,t=e.ParentId,i=e.isNewForm,a=e.itemId,n=e.formKey,o=i?"add":"edit";return s.createElement("div",null,s.createElement(yt,{FormMode:o,ParentId:+t,ExpId:+a,key:n}))}},{key:"componentDidUpdate",value:function(e,t){var i=Be.a.parse(this.props.location.search);if(i){var a="",n="";for(var o in i)o.toUpperCase()===N.a.PlanExperiment.IdParam.toUpperCase()&&(a=i[o]),o.toUpperCase()===N.a.PlanExperiment.ParentIdParam.toUpperCase()&&(n=i[o]);""!==a&&t.itemId!==a&&this.setState({isNewForm:!1,itemId:a,ParentId:n})}}},{key:"componentDidMount",value:function(){var e=Be.a.parse(this.props.location.search);if(e){var t="";for(var i in e)i.toUpperCase()===N.a.PlanExperiment.IdParam.toUpperCase()&&(t=e[i]);""!==t&&this.setState({isNewForm:!1,itemId:t,formKey:At()})}}}]),i}(s.Component)},147:function(e,t,i){},148:function(e,t,i){},187:function(e,t,i){e.exports=i(257)},192:function(e,t,i){},205:function(e,t,i){},206:function(e,t,i){},211:function(e,t,i){},232:function(e,t,i){},235:function(e,t,i){},236:function(e,t,i){},241:function(e,t,i){},254:function(e,t,i){},257:function(e,t,i){"use strict";i.r(t);var a=i(0),n=i.n(a),o=i(39),r=i.n(o),s=(i(192),i(6)),c=i(8),l=i(12),d=i(11),m=i(62),u=i(52),p=i(268),h=i(49),v=i(175),f=i(170),g=i(31),E=(i(205),i(44)),y=Object(g.a)();Object(f.a)();var A=function(e){Object(l.a)(i,e);var t=Object(d.a)(i);function i(){var e;Object(s.a)(this,i);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).logoinCall=function(){u.a.login()},e}return Object(c.a)(i,[{key:"render",value:function(){var e=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(m.AzureAD,{provider:u.a,forceLogin:!0},(function(t){var i=t.authenticationState,a=t.accountInfo;return n.a.createElement(n.a.Fragment,null,i===m.AuthenticationState.Authenticated&&n.a.createElement(E.a,{history:y,accountInfo:a}),i===m.AuthenticationState.InProgress&&n.a.createElement("div",{className:"centeredContainer"},n.a.createElement(p.a,{size:h.a.large})),i===m.AuthenticationState.Unauthenticated&&n.a.createElement("div",{className:"centeredContainer"},"Authenticating user...",n.a.createElement(v.a,{onClick:e.logoinCall,allowDisabledFocus:!0},"Force Retry")))})))}}]),i}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},44:function(e,t,i){"use strict";i.d(t,"b",(function(){return J})),i.d(t,"a",(function(){return Z}));var a=i(3),n=i.n(a),o=i(57),r=i(6),s=i(8),c=i(12),l=i(11),d=i(0),m=i(9),u=(i(206),i(5)),p=function(){return d.createElement("footer",{className:"footer"},d.createElement("div",{className:"AppFooter"},d.createElement("div",{dangerouslySetInnerHTML:{__html:u.a.Footer}})))},h=i(310),v=i(4),f=i(324),g=i(28),E=i(78),y=i(323),A=i(108),S=i(166),D=i(24),x=i(52),N={root:{textAlign:"center"},linkIsSelected:{selectors:{"::before":{backgroundColor:"white"}}}},C={initials:{color:"white!important"}},I={primaryText:{fontWeight:"600"},tertiaryText:{display:"block"}},b=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){var a;return Object(r.a)(this,i),(a=t.call(this,e)).handleUserInfoPanelClick=function(){a.setState((function(e){return{isOpen:!e.isOpen}}))},a.logoutCall=function(){x.a.logout()},a.handlePivotClick=function(e){var t=(null===e||void 0===e?void 0:e.props.headerButtonProps)["data-linktext"];a.setState({selectedKey:null===e||void 0===e?void 0:e.props.itemKey,isNavigate:!0}),a.props.history.push(t),a.props.handleRedirection(null===e||void 0===e?void 0:e.props.itemKey)},a.renderTertiaryText=function(){return d.createElement("ul",{className:"accountCntrlinks"},d.createElement("li",null,d.createElement("span",{className:"spanLink",onClick:a.logoutCall},"Sign out"," ")))},a.state={isOpen:!1,selectedKey:"0",isNavigate:!1},a}return Object(s.a)(i,[{key:"componentDidMount",value:function(){var e=this.props.selectedKey;this.setState({selectedKey:e})}},{key:"componentDidUpdate",value:function(e,t){var i=this.props.selectedKey;this.state.selectedKey!==i&&this.setState({selectedKey:i,isNavigate:!1})}},{key:"render",value:function(){var e=this.props,t=e.userDetail,i=e.appImageURL,a=e.appLogoText,n=this.state,o=n.isOpen,r=n.selectedKey,s=n.isNavigate;return d.createElement(d.Fragment,null,d.createElement("header",{className:"App-header"},d.createElement("div",{className:"row AppHeaderSection"},d.createElement("div",{className:"AppLogo"},i?d.createElement("img",{src:i,alt:"mainLogo",className:"AppLogoImage"}):d.createElement("div",{className:"MainAppLogoDiv"},d.createElement("div",{className:"AppLogoImg headerLogDiv"}),d.createElement("div",{style:{paddingLeft:"10px"}},a))),d.createElement("div",{className:"AppHeaderTxt"},d.createElement(y.a,{"aria-label":"Main Navigation",linkFormat:A.a.links,styles:N,className:"Navigation",selectedKey:r||"0",onLinkClick:this.handlePivotClick.bind(this)},d.createElement(S.a,{headerText:"Home",headerButtonProps:{"data-order":1,"data-title":"Home","data-linktext":"/Home"},itemKey:"0"},s?d.createElement(D.a,{to:"/Home"}):""),d.createElement(S.a,{headerButtonProps:{"data-linktext":"/PlanExperiment"},headerText:"Plan Experiment",itemKey:"1"},s?d.createElement(D.a,{to:"/PlanExperiment"}):""),d.createElement(S.a,{headerButtonProps:{"data-linktext":"/PlanActivity"},headerText:"Plan Lab Activity",itemKey:"2"},s?d.createElement(D.a,{to:"/PlanActivity"}):""),d.createElement(S.a,{headerButtonProps:{"data-linktext":"/PlanOfficeSpace"},headerText:"Plan Office Usage",itemKey:"3"},s?d.createElement(D.a,{to:"/PlanOfficeSpace"}):""),d.createElement(S.a,{headerButtonProps:{"data-linktext":"/Calendar"},headerText:"Calendar",itemKey:"4"},s?d.createElement(D.a,{to:"/Calendar"}):""),d.createElement(S.a,{headerButtonProps:{"data-linktext":"/MyActivities"},headerText:"My Activities",itemKey:"5"},s?d.createElement(D.a,{to:"/MyActivities"}):""))),t&&d.createElement("div",{className:"AppUserInfo"},d.createElement("div",{className:"AppUserInfoDiv",onClick:this.handleUserInfoPanelClick},d.createElement(h.a,{coinSize:35,className:"infoBtnHeaderPerson",secondaryText:t.userName,text:t.name,size:v.c.size24,coinProps:{styles:C},hidePersonaDetails:!0}))))),t&&d.createElement(f.a,{headerText:"My Account",isOpen:o,isLightDismiss:!0,isBlocking:!1,type:g.a.smallFixedFar,onDismiss:this.handleUserInfoPanelClick,closeButtonAriaLabel:"Close"},d.createElement("div",{className:"accountHeader",style:{boxShadow:E.a.depth4}},d.createElement(h.a,{coinSize:90,className:"infoBtnHeaderPerson",secondaryText:t.userName,tertiaryText:"signout",showSecondaryText:!0,text:t.name,size:v.c.size24,coinProps:{styles:C},onRenderTertiaryText:this.renderTertiaryText,styles:I}))))}}]),i}(d.Component),w=i(268),k=i(49),F=i(132),T=[{PathName:"/Home",PathKey:"0"},{PathName:"/PlanExperiment",PathKey:"1"},{PathName:"/PlanActivity",PathKey:"2"},{PathName:"/PlanOfficeSpace",PathKey:"3"},{PathName:"/Calendar",PathKey:"4"},{PathName:"/MyActivities",PathKey:"5"}],L=i(171),O=i(317),M=i(321),P=i(326),R=function(e){var t=Object(P.a)(!1),i=Object(L.a)(t,2),a=i[0],n=i[1].toggle;return d.createElement("div",{className:"centeredContainer",style:{textAlign:"center",top:"45%"}},d.createElement("h1",null,"404 - Page Not found"),a?d.createElement(D.a,{to:"/Home"}):"",d.createElement("h3",null,d.createElement(O.a,{onClick:n,style:{fontSize:24,color:"black"}},d.createElement(M.a,{iconName:"NavigateBack",className:"iconPadClasss"}),"Home")))},B=i(31),U=Object(B.a)(),j=d.lazy((function(){return Promise.resolve().then(i.bind(null,132)).then((function(e){return{default:e.PlanActivity}}))})),_=d.lazy((function(){return i.e(3).then(i.bind(null,329))})),q=d.lazy((function(){return Promise.resolve().then(i.bind(null,132)).then((function(e){return{default:e.MyActivites}}))})),H=d.lazy((function(){return Promise.resolve().then(i.bind(null,132)).then((function(e){return{default:e.PlanOfficeSpace}}))})),G=d.lazy((function(){return Promise.resolve().then(i.bind(null,132)).then((function(e){return{default:e.PlanExperiment}}))})),V=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){var a;return Object(r.a)(this,i),(a=t.call(this,e)).getSelectedKeyFromConfig=function(e){var t="0",i=m.filter(T,{PathName:e});return i.length>0&&(t=i[0].PathKey),t},a.handleClick=function(e){a.setState({selectedKey:e})},a.state={selectedKey:"0"},a}return Object(s.a)(i,[{key:"componentDidMount",value:function(){var e=window.location.pathname,t=this.getSelectedKeyFromConfig(e);this.setState({selectedKey:t})}},{key:"componentDidUpdate",value:function(e,t){var i=this.props.selectedKey;e.selectedKey!==i&&this.setState({selectedKey:i})}},{key:"render",value:function(){var e=this,t=this.state.selectedKey,i=this.props.accountInfo;return d.createElement(D.c,{history:U},d.createElement(b,Object.assign({},this.props,{iconName:u.a.Icons.appIconName,appImageURL:u.a.Images.AppHeaderImage,appLogoText:u.a.Headings.AppLogoText,userDetail:i.account,selectedKey:t,handleRedirection:this.handleClick})),d.createElement(d.Suspense,{fallback:d.createElement("div",{className:"centeredContainer"},d.createElement(w.a,{size:k.a.large}))},d.createElement(D.d,null,d.createElement(D.b,{exact:!0,path:"/",render:function(t){return d.createElement(F.Home,{handleRedirection:e.handleClick})}}),d.createElement(D.b,{path:"/Home",render:function(t){return d.createElement(F.Home,{handleRedirection:e.handleClick})}}),d.createElement(D.b,{path:"/PlanActivity",render:function(t){return d.createElement(j,Object.assign({},t,{handleRedirection:e.handleClick}))}}),d.createElement(D.b,{path:"/PlanExperiment",render:function(t){return d.createElement(G,Object.assign({},t,{handleRedirection:e.handleClick}))}}),d.createElement(D.b,{path:"/PlanOfficeSpace",render:function(t){return d.createElement(H,Object.assign({},t,{handleRedirection:e.handleClick}))}}),d.createElement(D.b,{path:"/Calendar",render:function(t){return d.createElement(_,Object.assign({},t,{handleRedirection:e.handleClick}))}}),d.createElement(D.b,{path:"/MyActivities",render:function(t){return d.createElement(q,Object.assign({},t,{handleRedirection:e.handleClick}))}}),d.createElement(D.b,{component:R}))))}}]),i}(d.Component),K=i(54),W=i(75),Y=i(16),z={getSystemAdmin:function(){return new Promise((function(e,t){Y.get("/api/SystemAdmin").then((function(t){e(t.data)})).catch((function(e){console.log(e.response),t(e)}))}))}},J=d.createContext({name:"",userName:"",isAdmin:!1}),Z=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){var a;return Object(r.a)(this,i),(a=t.call(this,e)).getAccessToken=Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(W.a)();case 2:case"end":return e.stop()}}),e)}))),a.getSytstemAdminData=function(){return new Promise((function(e,t){z.getSystemAdmin().then((function(t){return e(t)})).catch((function(e){t(e)}))}))},a.state={selectedKey:"0",systemAdmins:[],isLoaded:!1},a}return Object(s.a)(i,[{key:"componentDidMount",value:function(){var e=this,t=this.props.accountInfo;K.a.createCacheItem("accountInfo",JSON.stringify(t),1),this.getAccessToken(),this.getSytstemAdminData().then((function(i){if(i.length>0){var a,n=m.filter(i,(function(e){return e.SystemAdminEmailId.toUpperCase()===t.account.userName.toUpperCase()}));a=(null===n||void 0===n?void 0:n.length)>0,t.account.isAdmin=a,e.setState({isLoaded:!0,systemAdmins:i})}else console.log("No System admins")})).catch((function(t){e.setState({isLoaded:!0}),console.log("System Admins not found",t)}))}},{key:"render",value:function(){var e=this.props.accountInfo,t=this.state.selectedKey;return d.createElement("div",{className:"App"},d.createElement("div",{className:"HeaderSection"}),d.createElement("div",{className:"AppBody"},d.createElement(J.Provider,{value:e.account},d.createElement(V,Object.assign({},this.props,{selectedKey:t,accountInfo:e})))),d.createElement(p,null))}}]),i}(d.Component)},5:function(e,t,i){"use strict";var a={id:"5db054fadd74b4130864041b",Icons:{appIconName:""},Images:{AppHeaderImage:""},Headings:{AppLogoText:"TRN Digital - SWFT",MainAppHeading:"SWFT",sectionAppHeading:"TRN Digital - SWFT",sectionQuestionsHeading:"TRN Digital - SWFT"},UserTimeZone:"Asia/Kolkata",DateFormats:{NoTimeDate:"MM/DD/YYYY",dateFormat:"DD-MM-YYYY hh:mm:ss A",viewFormDateFormat:"DD-MM-YYYY hh:mm:ss A (zZ)",flatPickrOutputFormat:"YYYY-MM-DD HH:mm:ss",flatPickrInputFormat:"MM/DD/YYYY hh:mm A",utcDateFormat:"YYYY-MM-DDTHH:mm:SSZ"},ActivityForm:{FormRedirectionTimmer:3500,IdParam:"ID",ViewParam:"VIEW",OfcAndIndiActivityType:"Single",TBDRejectDispName:"TBD",TBDRejectShiftId:1,showTBD:!0,AtivityDateFormat:"YYYY-MM-DDT00:00:00",NoShiftsErrorMsg:"No shifts to Display",NoLocationEquipmentErrorMsg:"No Locations and activities",ErrorDataFetchMessage:"Error: Fetch failed to get Shift-Location-Equipment Data.Please inform the administration",ErrorValidationMessage:"Please complete the required fields before proceeding to save the form.",ErrorLSADataFetchMessage:"Error: Fetch failed to get Shift-Location-Availability Data for the table.Please inform the administration",CreationErrorMessage:"Activity Creation failed.\n",CloneErrorMessage:"Activity Clone failed.\n",UpdateErrorMessage:"Activity Update failed.\n",DeleteErrorMessage:"Activity Delete failed.\n",FullyBookedAlertMsg:"The location(s) are fully booked for the selected shift(s) and day.",FullyBookedDialogMsg:"The location(s) are fully booked for the selected shift(s) and day. By clicking, yes below, you are acknowledging that your booking will create an overcapacity scenario. By proceeding with this, you are fully responsible for ensuring that this overcapacity conflict is mitigated prior to this event. Failure to comply is going against established work rules, and compromising the health and safety of others.",officeSpaceUsageLocation:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_AAD_CLIENT_ID:"3e54e1d2-906c-4113-8638-d49c6dbbbb13",REACT_APP_AAD_TENANT_ID:"ecfe8182-3217-4e0b-9fb1-f8ad05aaca36",REACT_APP_APPLICATION_NAME:"SWFT - Obsidian"}).REACT_APP_OFFICE_LOCATION_ID?parseInt(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_AAD_CLIENT_ID:"3e54e1d2-906c-4113-8638-d49c6dbbbb13",REACT_APP_AAD_TENANT_ID:"ecfe8182-3217-4e0b-9fb1-f8ad05aaca36",REACT_APP_APPLICATION_NAME:"SWFT - Obsidian"}).REACT_APP_OFFICE_LOCATION_ID):13,officeSpaceUsageLocationName:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_AAD_CLIENT_ID:"3e54e1d2-906c-4113-8638-d49c6dbbbb13",REACT_APP_AAD_TENANT_ID:"ecfe8182-3217-4e0b-9fb1-f8ad05aaca36",REACT_APP_APPLICATION_NAME:"SWFT - Obsidian"}).REACT_APP_OFFICE_LOCATION_NAME?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_AAD_CLIENT_ID:"3e54e1d2-906c-4113-8638-d49c6dbbbb13",REACT_APP_AAD_TENANT_ID:"ecfe8182-3217-4e0b-9fb1-f8ad05aaca36",REACT_APP_APPLICATION_NAME:"SWFT - Obsidian"}).REACT_APP_OFFICE_LOCATION_NAME:"Office",InactiveStatusId:2},Calendar:{Heading:"Activity Calendar",NextDateDispString:"ddd DD-MMM",CalendarDateFormat:"YYYY-MM-DDT00:00:00"},PlanExperiment:{IdParam:"ID",ParentIdParam:"PARENTID",ViewParam:"VIEW",FormRedirectionTimmer:2e3,ExpDateFormat:"YYYY-MM-DDT00:00:00"},Footer:"\xa9 TRN Digital 2020"};t.a=a},50:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return o}));i(5),i(21);function a(e){var t=[];return e.forEach((function(e,i){var a=t.filter((function(t){return t.ActivityId===e.ActivityId&&t.ShiftId===e.ShiftId}));a.length<1?t.push(e):a[0].EquipmentName!=e.EquipmentName&&null!=e.EquipmentName&&(a[0].EquipmentName=a[0].EquipmentName+","+e.EquipmentName)})),t}function n(e,t){return e.toUpperCase()===t.toUpperCase()}function o(e,t,i){var a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return t?i?a[e].toUpperCase():a[e]:i?a[e].toUpperCase().substring(0,3):a[e].substring(0,3)}},52:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return o}));var a=i(62),n={scopes:["user.read","people.read"]},o=new a.MsalAuthProvider({auth:{authority:"https://login.microsoftonline.com/".concat("ecfe8182-3217-4e0b-9fb1-f8ad05aaca36"),clientId:"3e54e1d2-906c-4113-8638-d49c6dbbbb13",postLogoutRedirectUri:window.location.origin,redirectUri:window.location.origin,validateAuthority:!0,navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}},n,{loginType:a.LoginType.Redirect},{tokenRefreshUri:window.location.origin+"/auth.html"})},54:function(e,t,i){"use strict";i(237)();var a={storageType:window.localStorage,storagekeyString:"ObsidianSWFT2020_",storageitem:{key:"",ExpiryDate:"",value:"",createdDate:""},createCacheItem:function(e,t,i){var n={},o=(new Date).getTime(),r=a.storagekeyString+e;n.value=t,n.created=o,n.expireTime=36e5*i,a.storageType.setItem(r,JSON.stringify(n))},removeCacheItem:function(e){var t;t=a.storagekeyString+e,a.storageType.removeItem(t)},updateCacheItem:function(e,t,i){a.removeCacheItem(e),a.createCacheItem(e,t,i)},getCacheItem:function(e){var t="",i="",n="";try{return n=a.storagekeyString+e,t=a.storageType.getItem(n),i=JSON.parse(t)}catch(o){return console.log(o),i}},isCacheExpired:function(e){var t=!0,i=null,n=(new Date).getTime();try{if((i=a.getCacheItem(e))&&i.value){t=i.created+i.expireTime-n>0}else t=!1}catch(o){console.log(o),t=!1}return t}};t.a=a},75:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"d",(function(){return m})),i.d(t,"c",(function(){return p})),i.d(t,"b",(function(){return v}));var a=i(3),n=i.n(a),o=i(57),r=i(52),s=i(54),c=i(256);function l(e){return d.apply(this,arguments)}function d(){return(d=Object(o.a)(n.a.mark((function e(t){var i,a,o,l,d,m,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=!1,a="",o={},l={};try{i=s.a.isCacheExpired("accountInfo")}catch(n){console.log(n),i=!1}if(!i||!t){e.next=6;break}a=t,e.next=30;break;case 6:return e.prev=6,e.next=9,r.a.acquireTokenSilent(r.b);case 9:o=e.sent,d=s.a.getCacheItem("accountInfo"),(l=JSON.parse(d.value)).jwtAccessToken=o.accessToken,l.account=o.account,s.a.updateCacheItem("accountInfo",JSON.stringify(l),1),a=o.accessToken,e.next=30;break;case 18:return e.prev=18,e.t0=e.catch(6),console.log("account Info error",e.t0),e.next=23,r.a.acquireTokenSilent(r.b);case 23:o=e.sent,m=s.a.getCacheItem("accountInfo"),(l=JSON.parse(m.value)).jwtAccessToken=o.accessToken,l.account=o.account,s.a.updateCacheItem("accountInfo",JSON.stringify(l),72),a=o.accessToken;case 30:return u=c.Client.init({debugLogging:!0,authProvider:function(e){e(null,a)}}),e.abrupt("return",u);case 32:case"end":return e.stop()}}),e,null,[[6,18]])})))).apply(this,arguments)}function m(e,t){return u.apply(this,arguments)}function u(){return(u=Object(o.a)(n.a.mark((function e(t,i){var a,o,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(i);case 2:return a=e.sent,o=a.api("/users").filter("startswith(displayName,'".concat(t,"')")).select("displayName,givenName,surname,mail,userPrincipalName,id").top(25).get(),r=a.api("/groups").filter("startswith(displayName,'".concat(t,"') and groupTypes/any(c:c+eq+'Unified')")).select("displayName,givenName,surname,mail,userPrincipalName,id").top(25).get(),e.abrupt("return",Promise.all([o,r]).then((function(e){return[].concat.apply([],e.map((function(e){return e.value.length>0?e.value:[]})))})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t){return h.apply(this,arguments)}function h(){return(h=Object(o.a)(n.a.mark((function e(t,i){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(i);case 2:return a=e.sent,e.abrupt("return",new Promise((function(e,i){a.api("users/".concat(t.props.id,"/photo/$value")).header("Cache-Control","no-cache").responseType("blob").get((function(e,a){e?i(e):(t.imageUrl=window.URL.createObjectURL(a),t.initialsColor=null)}))})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return f.apply(this,arguments)}function f(){return(f=Object(o.a)(n.a.mark((function e(t){var i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t);case 2:return i=e.sent,e.abrupt("return",new Promise((function(e,t){i.api("/me/people").filter("personType/class eq 'Person'").select("displayName,givenName,surname,scoredEmailAddresses,userPrincipalName").top(25).get((function(i,a){i?t(i.message):e(a?a.value:[])}))})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},80:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var a=i(0),n=i.n(a),o=i(267),r=i(63),s=i(268),c=i(49),l=function(e){return n.a.createElement("div",null,n.a.createElement(o.a,{hidden:e.hideDialog,dialogContentProps:{type:r.a.largeHeader,title:"",subText:"",styles:{content:{borderTop:0}}},modalProps:{isBlocking:!0,styles:{main:{minWidth:200,minHeight:100}}}},n.a.createElement(s.a,{label:e.label,ariaLive:"assertive",labelPosition:"right",size:c.a.large})))}},94:function(e,t,i){"use strict";i.d(t,"j",(function(){return p})),i.d(t,"d",(function(){return h})),i.d(t,"g",(function(){return v})),i.d(t,"c",(function(){return f})),i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return E})),i.d(t,"i",(function(){return y})),i.d(t,"e",(function(){return A})),i.d(t,"f",(function(){return S})),i.d(t,"h",(function(){return x}));var a=i(45),n=i(47),o=i(9),r=i(5),s=i(16),c=i(21);var l={getCalendarData:function(e){return new Promise((function(t,i){var a=function(e){var t={};try{t.CalenderDate=e?c(e).format(r.a.Calendar.CalendarDateFormat):""}catch(i){console.log(i.response),t=!1}return t}(e);if(!a){i("Error in processing Data. Activity Date is not found")}s.post("/api/Calendar",{jsonObj:a}).then((function(e){t(e.data)})).catch((function(e){console.log(e.response),i(e)}))}))},getLocationdata:function(){return new Promise((function(e,t){s.get("/api/Location").then((function(t){e(t.data)})).catch((function(e){console.log(e.response),t(e)}))}))}},d=i(97),m=i(50),u=(i(125),i(21)),p=new Date;function h(e){return e?u.utc(e).format(r.a.Calendar.CalendarDateFormat):u().format(r.a.Calendar.CalendarDateFormat)}function v(e){var t=Object(n.a)(e),i=[],r=[];return o.each(t,(function(t){if(-1===i.indexOf(t.LocationId)){i.push(t.LocationId);var n={},s=o.map(o.filter(e,{LocationId:t.LocationId}),"EquipmentName");n.LocationId=t.LocationId,n.LocationName=t.LocationName,n.LocationDescription=t.LocationDescription,n.LocationCapacity=t.LocationCapacity,n.EquipmentArr=[],s&&s.length>0&&(n.EquipmentArr=s),r.push(Object(a.a)({},n))}})),r}function f(e){var t=new Date(e);return u.utc(t).format(r.a.Calendar.NextDateDispString)}function g(e,t,i,a){return o.filter(e,{LocationId:t,ActivityDate:i,ShiftId:a})}function E(e,t,i,n,r){for(var s=[],c=0;c<t.length;c++){var l=t[c],d={};d.LocationCapacity=l.LocationCapacity,d.LocationDescription=l.LocationDescription,d.LocationId=l.LocationId,d.LocationName=l.LocationName,d.CalData=[];for(var u=[],p=0;p<e.length;p++){for(var h=[],v=0;v<i.length-1;v++){var f=i[v],g={ShiftId:f.Id,ShiftName:f.Name,ActivityNumber:0,ShiftColor:"White",isStar:!1};h.push(JSON.parse(JSON.stringify(g)))}var E=e[p],y={DayIndex:E.DayIndex,ShiftData:h.splice(0),Date:E.DateStringDB};u.push(JSON.parse(JSON.stringify(y)))}d.CalData=u.splice(0),s.push(d)}console.log("ResultantObj",s),console.log("calendarData",n);var A={},S=function(e,t,i){for(var a=t,n=[],r=function(t){var r=a[t];c=r.LocationCapacity,o.each(r.CalData,(function(t){var a=o.filter(e,{LocationId:r.LocationId,ActivityDate:t.Date}),s=m.b(a);if(t.TotalInLocation=s.length>0?s.length:0,s.length>0){o.forEach(s,(function(e){n.push(e)}));var l=o.groupBy(s,"ShiftId");l&&o.each(t.ShiftData,(function(e){var t=l[e.ShiftId];if(t){var a;a=o.map(t,"BookedForEmail");var n=o.uniq(a);e.ActivityNumber=n.length,e.ShiftColor=function(e,t){if(0===e)return"White";if(e<t)return"Green";if(e===t)return"Grey";if(e>t)return"Red"}(n.length,c),e.isStar=function(e,t){var i=o.map(e,"BookedForEmail");if(i&&-1!==i.indexOf(t))return!0;return!1}(t,i)}}))}}))},s=0;s<a.length;s++){var c;r(s)}var l={};return l.calendarData=a,l.activitiesData=n,l}(n,s,r),D=function(e,t,i){for(var n=[],r=0;r<e.length;r++){for(var s=e[r],c=[],l=0;l<t.length-1;l++){var d=t[l],m=o.map(o.filter(i,{ActivityDate:s.DateStringDB,ShiftId:d.Id}),"BookedForEmail"),u=m?o.uniq(m):[],p={ShiftId:d.Id,ShiftName:d.Name,ActivityNumber:u?u.length:0,ShiftColor:"White",isStar:!1};c.push(Object(a.a)({},p))}var h={DayIndex:s.DayIndex,ShiftData:c.splice(0),Date:s.DateStringDB,TotalInLocation:0};n.push(Object(a.a)({},h))}return n}(e,i,S.activitiesData);return A.calendarData=S.calendarData,A.activitiesData=S.activitiesData,A.totolCountArr=D,console.log(A),A}function y(){return new Promise((function(e,t){d.a.getShiftsData().then((function(t){return e(t)})).catch((function(e){t(e)}))}))}function A(e){return new Promise((function(t,i){l.getCalendarData(e).then((function(e){t(e)})).catch((function(e){i(e)}))}))}function S(){return new Promise((function(e,t){l.getLocationdata().then((function(t){return e(t)})).catch((function(e){t(e)}))}))}var D=["Day1","Day2","Day3","Day4","Day5","Day6","Day7"];function x(e,t){var i=u(e).format(r.a.DateFormats.NoTimeDate),n=[];if(t>0){n=[];for(var o=0;o<=t;o++){var s=new Date(i);s.setDate(s.getDate()+o);var c=s,l={};l.DayIndex=D[o],l.Day=m.a(s.getDay(),!0,!1),l.DateObj=c,l.DateString=u(c).format(r.a.Calendar.NextDateDispString),l.DateStringDB=u(c).format(r.a.Calendar.CalendarDateFormat)+".000Z",n.push(Object(a.a)({},l))}}return console.log(n),n}},97:function(e,t,i){"use strict";var a=i(16);i(5);var n={getShiftsData:function(){return new Promise((function(e,t){a.get("/api/Shifts").then((function(t){e(t.data)})).catch((function(e){console.log(e.response),t(e)}))}))},getShiftLocationAvaliability:function(e){return new Promise((function(t,i){var n=function(e){var t={};try{t.ActivityDate=e.activityDate?e.activityDate:""}catch(i){console.log(i.response),t=!1}return t}(e);if(!n){i("Error in processing Data. Activity Date not found")}a.post("/api/Shifts/GetLocationAvailability",{jsonObj:n}).then((function(e){t(e.data)})).catch((function(e){console.log(e.response),i(e)}))}))}};t.a=n}},[[187,1,2]]]);
//# sourceMappingURL=main.acaa1e00.chunk.js.map